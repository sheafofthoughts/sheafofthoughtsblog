[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Recent Posts",
    "section": "",
    "text": "Why Fermat had (probably) no proof?\n\n\n\n\n\n\nIntermediate\n\nNumber Theory\n\nAlgebraic Geometry\n\n\n\nWe explain why, if Fermat had a proof, it should have been very remarkable.\n\n\n\n\n\nDec 18, 2025\n\n\n\n\n\n\n\nSome basic modular arithmetic\n\n\nFermat’s Christmas Theorem series\n\n\n\nExpository\n\n\n\nWe introduce modular arithmetic and understand the meaning of Chinese Remainder Theorem.\n\n\n\n\n\nDec 14, 2025\n\n\n\n\n\n\n\nSome interesting consequences of Chebotarev density theorem\n\n\n\n\n\n\nIntermediate\n\nNumber Theory\n\n\n\nWe will prove how some interesting propositions follow from the Chebotarev density theorem.\n\n\n\n\n\nDec 13, 2025\n\n\n\n\n\n\n\nHow many primes are there?\n\n\nFermat’s Christmas Theorem series\n\n\n\nExpository\n\n\n\nExpository tour of Euclid’s proof that there are infinitely many primes, preceded by a discussion of Euclidean division and the fundamental theorem of arithmetic.\n\n\n\n\n\nDec 8, 2025\n\n\n\n\n\n\n\nAx–Grothendieck Theorem\n\n\nWhen does injectivity imply bijectivity?\n\n\n\nIntermediate\n\nAlgebraic Geometry\n\n\n\nWe investigate when injectivity is sufficient for surjectivity in an algebraic setting. We first treat the case of an algebraically closed field and give a complete proof, then discuss generalizations to schemes.\n\n\n\n\n\nDec 7, 2025\n\n\n\n\n\n\n\nIntroduction to Fermat’s Christmas Theorem\n\n\nFermat’s Christmas Theorem series\n\n\n\nExpository\n\n\n\nWe introduce Fermat’s Christmas Theorem and try to understand its meaning through concrete examples.\n\n\n\n\n\nNov 29, 2025\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "IT/fermat-christmas-theorem/howmanyprimes/how-many-primes-IT.html",
    "href": "IT/fermat-christmas-theorem/howmanyprimes/how-many-primes-IT.html",
    "title": "Quanti numeri primi ci sono?",
    "section": "",
    "text": "ENG ITA"
  },
  {
    "objectID": "IT/fermat-christmas-theorem/howmanyprimes/how-many-primes-IT.html#che-cosè-un-primo",
    "href": "IT/fermat-christmas-theorem/howmanyprimes/how-many-primes-IT.html#che-cosè-un-primo",
    "title": "Quanti numeri primi ci sono?",
    "section": "Che cos’è un primo?",
    "text": "Che cos’è un primo?\nIniziamo con un breve ripasso. A scuola abbiamo imparato che un intero positivo è primo se i suoi soli divisori sono \\(1\\) e se stesso (\\(1\\) non è considerato primo). Quindi \\(2,3,5,\\dots\\) sono primi.\nConsideriamo il primo \\(2\\). Osserviamo che ogni volta che \\(2\\) divide un prodotto di due interi \\(a\\cdot b\\), divide uno dei due fattori (cioè o \\(2\\) divide \\(a\\) oppure \\(2\\) divide \\(b\\)). Prova qualche esempio per convincerti. Per esempio, \\(2\\) divide il prodotto \\(4\\cdot 5=20\\) e infatti \\(2\\) divide \\(4\\). Puoi provare con qualunque prodotto e la proprietà continuerà a valere. Tuttavia, non c’è nulla di speciale in \\(2\\); in realtà ogni numero primo soddisfa questa proprietà (cioè, se un numero primo \\(p\\) divide un prodotto \\(a\\cdot b\\) allora \\(p\\) divide \\(a\\) oppure \\(p\\) divide \\(b\\)). In realtà questa proprietà caratterizza i numeri primi. Per esempio, \\(6\\) (che non è primo) divide il prodotto \\(3\\cdot 4=12\\), ma non divide né \\(3\\) né \\(4\\).\nPoiché questa proprietà è importante, definiamo i numeri primi nel modo seguente:\n\nDefinizione: Un intero \\(p\\) è primo se ogni volta che \\(p\\) divide un prodotto \\(a\\cdot b\\), allora \\(p\\) divide \\(a\\) oppure \\(p\\) divide \\(b\\).\n\nUseremo invece il termine irriducibile per l’altra definizione che conosciamo:\n\nDefinizione: Un intero \\(q\\) è irriducibile se i suoi soli divisori sono se stesso, \\(1\\) e \\(-1\\).\n\nIncludiamo \\(-1\\) perché permettiamo anche interi negativi; ad esempio \\(-3\\) è irriducibile poiché i suoi soli divisori sono \\(-1\\), \\(1\\) e \\(-3\\).\nPer gli interi, un numero è irriducibile se e solo se è primo, quindi le due definizioni coincidono. Per questo usiamo spesso la definizione tramite irriducibilità per i numeri primi."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "I am a master’s student in mathematics, mostly interested in algebraic stuff. In this blog I share things that I find interesting while I study.\nI write as a student who is still learning, and these posts are a way to collect what I study and to share it with others."
  },
  {
    "objectID": "about.html#projects",
    "href": "about.html#projects",
    "title": "About",
    "section": "Projects",
    "text": "Projects\n\nInteresting facts\nPosts on more advanced topics (in algebraic geometry, number theory) that I encounter along the way (ideas that I like, want to remember, or want to understand better).\n\n\nRoute to the Fermat’s Christmas Theorem\nExpository weekly notes (aimed to non-experts) developing most of the theory needed to give a complete proof of the Fermat’s Christmas Theorem, starting from the very basics. I will try to write the posts in a very simple language, so that anyone could easily follow along."
  },
  {
    "objectID": "about.html#notes",
    "href": "about.html#notes",
    "title": "About",
    "section": "Notes",
    "text": "Notes\nEverything here is written in my free time, so there may be occasional errors. If you notice something unclear, feel free to open an issue on GitHub."
  },
  {
    "objectID": "posts/interesting-facts/chebotarev-corollaries/chebotarev-corollaries.html",
    "href": "posts/interesting-facts/chebotarev-corollaries/chebotarev-corollaries.html",
    "title": "Some interesting consequences of Chebotarev density theorem",
    "section": "",
    "text": "First of all, we recall some definitions we need; see Chapter VII, §13 of Neukirch (1999).\n\nDefinition: Let \\(K\\) be a number field and let \\(L/K\\) be a (finite) Galois extension with Galois group \\(G\\). For every \\(\\sigma \\in G\\) we define \\(P_{L|K}(\\sigma)\\) as the set of all (nonzero) prime ideals \\(\\mathfrak{p}\\) of \\(K\\) that are unramified in \\(L\\) and such that there exists a prime ideal \\(\\mathfrak{P}|\\mathfrak{p}\\) of \\(L\\) satisfying \\[\n    \\sigma=\\mathrm{Frob}^{L|K}_{\\mathfrak{P}},\n\\] where \\(\\mathrm{Frob}^{L|K}_{\\mathfrak{P}}\\in G\\) is the Frobenius automorphism of \\(\\mathfrak{P}\\) over \\(\\mathfrak{p}\\).\n\nSince for all \\(\\tau\\in G\\) we have \\[\n    \\mathrm{Frob}^{L|K}_{\\tau \\mathfrak{P}}=\\tau \\,\\mathrm{Frob}^{L|K}_{\\mathfrak{P}}\\,\\tau ^{-1},\n\\] the set \\(P_{L|K}(\\sigma)\\) only depends on the conjugacy class \\[\n\\langle \\sigma \\rangle:=\\{\\tau\\sigma\\tau ^{-1} \\mid \\tau \\in G\\}.\n\\] Moreover, if \\(\\langle\\sigma\\rangle\\neq \\langle \\tau \\rangle\\) then \\(P_{L|K}(\\sigma)\\cap P_{L|K}(\\tau)=\\emptyset\\).\nWe now want to define what a density is (for sets of primes of a number field).\n\nDefinition: Let \\(K\\) be a number field and let \\(S\\) be a set of nonzero prime ideals of \\(\\mathcal{O}_K\\). For \\(x\\ge 1\\) set \\[\nS(x):=\\{\\mathfrak{p}\\in S \\mid N\\mathfrak{p}\\le x\\},\\qquad \\pi_S(x):=|S(x)|.\n\\] Let \\(\\pi_K(x)\\) be the number of all nonzero prime ideals \\(\\mathfrak{p}\\subseteq \\mathcal{O}_K\\) with \\(N\\mathfrak{p}\\le x\\). If the limit exists, we define the natural density \\(d(S)\\) as \\[\nd(S):=\\lim_{x\\to \\infty}\\frac{\\pi_S(x)}{\\pi_K(x)}.\n\\]\n\n\n\nWe are now ready to state the theorem.\n\nTheorem 1 (Chebotarev density theorem) Let \\(K\\) be a number field and let \\(L/K\\) be a finite Galois extension with Galois group \\(G\\). Then for every \\(\\sigma \\in G\\), the set \\(P_{L|K}(\\sigma)\\) has density (the limit exists), and it is given by \\[\n    d(P_{L|K}(\\sigma))=\\frac{\\#\\langle \\sigma\\rangle}{\\#G}.\n\\]\n\nWe will not prove Theorem 1, since the argument is long and technical. For a complete proof you can look at Neukirch (1999)."
  },
  {
    "objectID": "posts/interesting-facts/chebotarev-corollaries/chebotarev-corollaries.html#the-theorem",
    "href": "posts/interesting-facts/chebotarev-corollaries/chebotarev-corollaries.html#the-theorem",
    "title": "Some interesting consequences of Chebotarev density theorem",
    "section": "",
    "text": "We are now ready to state the theorem.\n\nTheorem 1 (Chebotarev density theorem) Let \\(K\\) be a number field and let \\(L/K\\) be a finite Galois extension with Galois group \\(G\\). Then for every \\(\\sigma \\in G\\), the set \\(P_{L|K}(\\sigma)\\) has density (the limit exists), and it is given by \\[\n    d(P_{L|K}(\\sigma))=\\frac{\\#\\langle \\sigma\\rangle}{\\#G}.\n\\]\n\nWe will not prove Theorem 1, since the argument is long and technical. For a complete proof you can look at Neukirch (1999)."
  },
  {
    "objectID": "posts/interesting-facts/chebotarev-corollaries/chebotarev-corollaries.html#there-are-infinitely-many-primes-splitting-completely",
    "href": "posts/interesting-facts/chebotarev-corollaries/chebotarev-corollaries.html#there-are-infinitely-many-primes-splitting-completely",
    "title": "Some interesting consequences of Chebotarev density theorem",
    "section": "There are infinitely many primes splitting completely",
    "text": "There are infinitely many primes splitting completely\n\nDefinition: Let \\(L/K\\) be a finite extension of number fields of degree \\(n\\) and let \\(\\mathfrak{p}\\) be a prime of \\(K\\). We say that \\(\\mathfrak{p}\\) splits completely in \\(L\\) if the number of (distinct) prime ideals of \\(L\\) lying over \\(\\mathfrak{p}\\) is exactly \\(n\\). We define \\(P(L|K)\\) as the set of primes of \\(K\\) splitting completely in \\(L\\).\n\n\nCorollary 1 (Corollary of Theorem 1) Let \\(K\\) be a number field and let \\(L/K\\) be a finite extension. Then there are infinitely many primes of \\(K\\) splitting completely in \\(L\\).\n\n\nProof. First, suppose that \\(L/K\\) is Galois. Let \\(\\mathfrak{p}\\) be a prime of \\(K\\) unramified in \\(L\\), and let \\(\\mathfrak{P}|\\mathfrak{p}\\) in \\(L\\). Then \\[\n    \\mathfrak{p} \\text{ splits completely in } L \\iff \\mathrm{Frob}^{L|K}_{\\mathfrak{P}}=1_G.\n\\] Indeed, \\(\\mathfrak{p}\\) splits completely means that for every \\(\\mathfrak{P}|\\mathfrak{p}\\) we have \\(e(\\mathfrak{P}|\\mathfrak{p})=f(\\mathfrak{P}|\\mathfrak{p})=1\\) (respectively ramification index and residue degree), hence the decomposition group \\(D(\\mathfrak{P}|\\mathfrak{p})\\) is trivial. Since \\(\\mathfrak{p}\\) is unramified, the decomposition group is cyclic and generated by the Frobenius element, so \\[\n    D(\\mathfrak{P}|\\mathfrak{p}) \\text{ is trivial } \\iff \\mathrm{Frob}^{L|K}_{\\mathfrak{P}}=1_G.\n\\]\nTherefore, \\(P(L|K)=P_{L|K}(1_G)\\). Applying Theorem 1 we obtain \\[\n    d(P(L|K))=\\frac{1}{\\# \\mathrm{Gal}(L/K)}&gt; 0,\n\\] hence the set \\(P(L|K)\\) must be infinite (otherwise its density would be \\(0\\)).\nIf \\(L/K\\) is not Galois, let \\(M\\) be the Galois closure of \\(L\\) over \\(K\\). By the Galois case, \\(P(M|K)\\) is infinite. Moreover \\(P(M|K)\\subseteq P(L|K)\\) by multiplicativity of residue degrees and ramification indices in towers. Hence \\(P(L|K)\\) is infinite as well."
  },
  {
    "objectID": "posts/interesting-facts/chebotarev-corollaries/chebotarev-corollaries.html#characterization-of-number-fields-galois-over-k-through-splitting-of-primes",
    "href": "posts/interesting-facts/chebotarev-corollaries/chebotarev-corollaries.html#characterization-of-number-fields-galois-over-k-through-splitting-of-primes",
    "title": "Some interesting consequences of Chebotarev density theorem",
    "section": "Characterization of number fields (Galois over \\(K\\)) through splitting of primes",
    "text": "Characterization of number fields (Galois over \\(K\\)) through splitting of primes\n\nLemma 1 Let \\(K\\) be a number field, let \\(L\\) and \\(M\\) be two finite Galois extensions of \\(K\\), and \\(N:=LM\\) the composite field. Set \\[\nG:=\\mathrm{Gal}(N/K),\\qquad H_M:=\\mathrm{Gal}(N/M).\n\\] For every prime \\(\\mathfrak{p}\\) of \\(K\\) unramified in \\(N\\), pick a prime \\(\\mathfrak{P}\\) of \\(N\\) above \\(\\mathfrak{p}\\). Then \\[\n    \\mathfrak{p}\\in P(M|K)\\iff \\mathrm{Frob}^{N|K}_{\\mathfrak{P}}\\in H_M.\n\\]\n\n\nProof. Since \\(M/K\\) is Galois, the restriction map \\[\n\\mathrm{res}_M: G=\\mathrm{Gal}(N/K)\\to \\mathrm{Gal}(M/K)\n\\] is surjective with kernel \\(H_M\\). Since \\(\\mathfrak{p}\\) is unramified in \\(N\\), the Frobenius element is well-defined and it satisfies \\[\n    \\mathrm{res}_M\\big(\\mathrm{Frob}^{N|K}_{\\mathfrak{P}}\\big)=\\mathrm{Frob}^{M|K}_{\\mathfrak{P}\\cap M}\\in \\mathrm{Gal}(M/K).\n\\]\nNow observe that \\(\\mathfrak{p}\\) splits completely in \\(M\\) if and only if the Frobenius element in \\(\\mathrm{Gal}(M/K)\\) is trivial: \\[\n    \\mathfrak{p}\\in P(M|K)\\iff \\mathrm{Frob}^{M|K}_{\\mathfrak{P}\\cap M}=1.\n\\] This holds if and only if \\(\\mathrm{Frob}^{N|K}_{\\mathfrak{P}}\\in \\mathrm{ker}(\\mathrm{res}_M)=H_M\\).\n\n\nCorollary 2 (M. Bauer, corollary of Theorem 1) Let \\(K\\) be a number field and let \\(L\\) and \\(M\\) be two finite Galois extensions of \\(K\\). Then \\[\n    P(M|K) \\subseteq P(L|K) \\iff L \\subseteq M.\n\\] Therefore, \\[\n    P(M|K)=P(L|K)\\iff L=M.\n\\]\n\n\nRemark 1. The implication \\(P(M|K) \\subseteq P(L|K) \\Rightarrow L \\subseteq M\\) can be strengthened by allowing finitely many primes in \\(P(M|K)\\) not to lie in \\(P(L|K)\\); the proof remains unchanged.\n\n\nProof. If \\(L \\subseteq M\\) then \\(P(M|K) \\subseteq P(L|K)\\) because in a tower the ramification indices and residue degrees are multiplicative.\nConversely, define the composite field \\(N:=LM\\) and set \\[\nG:=\\mathrm{Gal}(N/K),\\quad H_L:=\\mathrm{Gal}(N/L),\\quad H_M:=\\mathrm{Gal}(N/M).\n\\]\nAssume for the sake of contradiction that \\(L\\not\\subseteq M\\). This is equivalent to \\(H_M\\not \\subseteq H_L\\). Choose \\(g\\in H_M\\smallsetminus H_L\\). Since \\(H_M\\) and \\(H_L\\) are normal, \\[\n\\langle g\\rangle \\subseteq H_M,\\quad \\langle g\\rangle \\cap H_L=\\emptyset.\n\\]\nBy Theorem 1 there are infinitely many primes \\(\\mathfrak{p}\\) of \\(K\\) unramified in \\(N\\) with Frobenius conjugacy class equal to \\(\\langle g\\rangle\\) (if it was finite, the density would be \\(0\\)). For such a \\(\\mathfrak{p}\\), pick \\(\\mathfrak{P}|\\mathfrak{p}\\) in \\(N\\); then \\[\n    \\mathrm{Frob}^{N|K}_{\\mathfrak{P}}\\in \\langle g\\rangle \\subseteq H_M.\n\\] By Lemma 1 we get \\(\\mathfrak{p}\\in P(M|K)\\).\nSimilarly, \\(\\mathfrak{p}\\in P(L|K)\\) would imply \\(\\mathrm{Frob}^{N|K}_{\\mathfrak{P}}\\in H_L\\), which is false here. Hence \\(\\mathfrak{p}\\notin P(L|K)\\). This contradicts \\(P(M|K) \\subseteq P(L|K)\\).\nTherefore \\(L\\subseteq M\\)."
  },
  {
    "objectID": "posts/interesting-facts/chebotarev-corollaries/chebotarev-corollaries.html#dirichlets-theorem-on-primes-in-arithmetic-progressions",
    "href": "posts/interesting-facts/chebotarev-corollaries/chebotarev-corollaries.html#dirichlets-theorem-on-primes-in-arithmetic-progressions",
    "title": "Some interesting consequences of Chebotarev density theorem",
    "section": "Dirichlet’s Theorem on primes in arithmetic progressions",
    "text": "Dirichlet’s Theorem on primes in arithmetic progressions\n\nCorollary 3 (Dirichlet’s Theorem) Let \\(a,n\\geq 1\\) be integers with \\(\\gcd(a,n)=1\\). Then there are infinitely many primes such that \\(p\\equiv a \\pmod n\\).\n\n\nProof. Let \\(\\zeta\\) be a primitive \\(n\\)-th root of unity, define \\(L:=\\mathbb{Q}(\\zeta)\\), and let \\(G:=\\mathrm{Gal}(L/\\mathbb{Q})\\). We know that \\(L/\\mathbb{Q}\\) is Galois and \\[\n    G\\cong (\\mathbb{Z}/n \\mathbb{Z})^\\times,\n\\] where the class of \\(b\\) corresponds to the automorphism sending \\(\\zeta\\) to \\(\\zeta^b\\).\nLet \\(p\\) be a prime with \\(p\\nmid n\\). Then \\(p\\) is unramified in \\(L\\), and for any prime \\(\\mathfrak{P}|p\\) in \\(L\\) the Frobenius automorphism satisfies \\[\n    \\mathrm{Frob}^{L|\\mathbb{Q}}_{\\mathfrak{P}}(\\zeta)=\\zeta^p.\n\\] In other words, under the isomorphism \\(G\\cong(\\mathbb{Z}/n\\mathbb{Z})^\\times\\), the Frobenius element corresponds to the class of \\(p \\bmod n\\).\nTherefore, \\[\n    p\\equiv a \\pmod n\n    \\quad\\iff\\quad\n    \\mathrm{Frob}^{L|\\mathbb{Q}}_{\\mathfrak{P}} \\text{ corresponds to } a\\in(\\mathbb{Z}/n\\mathbb{Z})^\\times.\n\\] By Theorem 1, the set of such primes has positive density, hence it is infinite. (The finitely many primes dividing \\(n\\) are irrelevant.)"
  },
  {
    "objectID": "posts/interesting-facts/chebotarev-corollaries/chebotarev-corollaries.html#condition-for-linearity-of-a-polynomial",
    "href": "posts/interesting-facts/chebotarev-corollaries/chebotarev-corollaries.html#condition-for-linearity-of-a-polynomial",
    "title": "Some interesting consequences of Chebotarev density theorem",
    "section": "Condition for linearity of a polynomial",
    "text": "Condition for linearity of a polynomial\n\nCorollary 4 Let \\(f\\in \\mathbb{Z}[X]\\) be an irreducible polynomial such that for all but finitely many primes \\(p\\) the reduction \\(\\bar f\\in \\mathbb{F}_p[X]\\) has a root. Then \\(\\deg(f)=1\\).\n\n\nProof. Let \\(n:=\\deg(f)\\) and suppose that \\(n&gt;1\\). Let \\(L\\) be the splitting field of \\(f\\) over \\(\\mathbb{Q}\\) and set \\(G:=\\mathrm{Gal}(L/\\mathbb{Q})\\). Let \\(\\Omega\\) be the set of roots of \\(f\\) in \\(L\\). Since \\(f\\) is irreducible, the action of \\(G\\) on \\(\\Omega\\) is transitive. By Burnside’s lemma (orbit-counting), there is some \\(\\sigma\\in G\\) with no fixed points in \\(\\Omega\\).\nLet \\(S\\) be a finite set of rational primes containing all primes ramified in the splitting field \\(L\\), and also containing all primes dividing \\(\\mathrm{Disc}(f)\\) or the leading coefficient of \\(f\\). For every \\(p\\notin S\\), the reduction \\((f\\bmod p)\\) is separable, and \\(p\\) is unramified in the splitting field \\(L\\). Moreover, the factorization type of \\((f\\bmod p)\\) corresponds to the cycle structure of \\(\\mathrm{Frob}^{L|\\mathbb{Q}}_{\\mathfrak{P}}\\) acting on \\(\\Omega\\), where \\(\\mathfrak{P}|p\\). In particular, \\((f\\bmod p)\\) has a root in \\(\\mathbb{F}_p\\) if and only if \\(\\mathrm{Frob}^{L|\\mathbb{Q}}_{\\mathfrak{P}}\\) has a fixed point in \\(\\Omega\\).\nBy Theorem 1, the set \\(P_{L|\\mathbb{Q}}(\\sigma)\\) is infinite (it has positive density). Since \\(S\\) is finite, there are infinitely many primes \\(p\\notin S\\) such that \\[\n    \\mathrm{Frob}^{L|\\mathbb{Q}}_{\\mathfrak{P}}\\in \\langle\\sigma\\rangle,\n\\] where \\(\\mathfrak{P}|p\\). For all such primes the Frobenius automorphism has no fixed points, thus the reduction of \\(f\\) has no roots modulo these primes. This is a contradiction, since we assumed that \\((f\\bmod p)\\) has a root for all but finitely many primes.\nTherefore \\(\\deg(f)=1\\)."
  },
  {
    "objectID": "posts/interesting-facts/chebotarev-corollaries/chebotarev-corollaries.html#how-many-mathbbf_p-points",
    "href": "posts/interesting-facts/chebotarev-corollaries/chebotarev-corollaries.html#how-many-mathbbf_p-points",
    "title": "Some interesting consequences of Chebotarev density theorem",
    "section": "How many \\(\\mathbb{F}_p\\)-points?",
    "text": "How many \\(\\mathbb{F}_p\\)-points?\n\nCorollary 5 Let \\(A\\) be a \\(\\mathbb{Z}\\)-algebra of finite type such that there exists a ring map \\(f:A\\to \\mathbb{C}\\). Then for infinitely many primes \\(p\\) there is a ring morphism \\(A\\to \\mathbb{F}_p\\).\n\nWhat we are saying is that if you consider a set of polynomials in \\(\\mathbb{Z}[X_1,\\dots , X_n]\\) (the polynomials defining \\(A\\) as a quotient of \\(\\mathbb{Z}[X_1,\\dots, X_n]\\)), then if they have a common solution in \\(\\mathbb{C}\\) (i.e. there is a map \\(A\\to \\mathbb{C}\\)), they have a common solution modulo \\(p\\), for infinitely many primes \\(p\\) (i.e. a map \\(A\\to \\mathbb{F}_p\\)).\n\nProof. Since we have a map \\(f:A\\to \\mathbb{C}\\), we get \\(A\\otimes_{\\mathbb{Z}}\\mathbb{C}\\neq 0\\), which is equivalent to \\(A\\otimes_{\\mathbb{Z}}\\mathbb{Q}\\neq 0\\) (because \\(\\mathbb{Q}\\to \\mathbb{C}\\) is faithfully flat). In particular, \\(A\\otimes_{\\mathbb{Z}}\\mathbb{Q}\\) has a maximal ideal \\(\\mathfrak{m}\\). Let \\[\nL := (A\\otimes_{\\mathbb{Z}}\\mathbb{Q})/\\mathfrak{m}.\n\\] By Zariski’s lemma, \\(L\\) is a finite extension of \\(\\mathbb{Q}\\), hence a number field.\nConsider now the composition map \\(\\phi: A\\to A\\otimes_{\\mathbb{Z}}\\mathbb{Q}\\to L\\). Let \\(a_1,\\dots,a_r\\) be generators of \\(A\\) as a \\(\\mathbb{Z}\\)-algebra. Choose \\(N\\in \\mathbb{Z}_{&gt;0}\\) such that \\(N\\cdot \\phi(a_i)\\) is an algebraic integer for every \\(i=1,\\dots, r\\). Then \\(\\phi(a_i)\\in \\mathcal{O}_L[1/N]\\) for all \\(i\\), hence \\(\\phi\\) lands in \\(\\mathcal{O}_L[1/N]\\), i.e. we have a map \\[\n\\phi: A\\to \\mathcal{O}_L[1/N].\n\\] Fix a rational prime \\(p\\) not dividing \\(N\\). Any prime ideal \\(\\mathfrak{P}\\) of \\(L\\) dividing \\(p\\) gives the reduction map \\[\n    \\mathcal{O}_L[1/N]\\to \\mathcal{O}_L/\\mathfrak{P}.\n\\] Moreover, if the residue degree satisfies \\(f(\\mathfrak{P}|p)=1\\), then \\(\\mathcal{O}_L/\\mathfrak{P}\\cong \\mathbb{F}_p\\), hence we get a map \\[\n    A\\to \\mathcal{O}_L[1/N]\\to \\mathcal{O}_L/\\mathfrak{P}\\cong \\mathbb{F}_p.\n\\] Since \\(p\\nmid N\\), this is the same as a map \\(A\\to \\mathbb{F}_p\\).\nBy Corollary 1 there are infinitely many primes \\(p\\) splitting completely in \\(L\\). Discarding the finitely many primes dividing \\(N\\), we can assume also \\(p\\nmid N\\). This gives a map \\(A\\to \\mathbb{F}_p\\) for infinitely many primes \\(p\\)."
  },
  {
    "objectID": "posts/fermat-christmas-theorem/integer-congruences/integer-congruences.html",
    "href": "posts/fermat-christmas-theorem/integer-congruences/integer-congruences.html",
    "title": "Some basic modular arithmetic",
    "section": "",
    "text": "ENG ITA"
  },
  {
    "objectID": "posts/fermat-christmas-theorem/integer-congruences/integer-congruences.html#easy-part-of-fermats-christmas-theorem",
    "href": "posts/fermat-christmas-theorem/integer-congruences/integer-congruences.html#easy-part-of-fermats-christmas-theorem",
    "title": "Some basic modular arithmetic",
    "section": "Easy part of Fermat’s Christmas Theorem",
    "text": "Easy part of Fermat’s Christmas Theorem\n\nProposition 3 Let \\(n\\) be an odd integer that can be written as the sum of two squares. Then \\(n\\equiv_4 1\\), or equivalently \\(n\\) has remainder \\(1\\) when divided by \\(4\\).\n\n\nRemark 2. In particular, the theorem also tells us that if \\(p\\) is an odd prime that can be written as the sum of two squares, then it has remainder \\(1\\) when divided by \\(4\\), which is part of what Fermat’s Christmas Theorem says.\n\n\nProof. If \\(n\\) can be written as the sum of two squares, it means that there exist integers \\(a,b\\) such that \\[\n  n=a^2+b^2.\n\\] Observe that \\(n\\) is odd, therefore it has remainder \\(1\\) when divided by \\(2\\), i.e. \\[\n  n\\equiv_2 1.\n\\] Therefore \\[\n  a^2+b^2\\equiv_2 1.\n\\]\nIf both \\(a\\) and \\(b\\) were odd, then \\(a\\equiv_2 1\\) and \\(b\\equiv_2 1\\), therefore \\[\n  a^2\\equiv_2 1,\\qquad b^2\\equiv_2 1,\n\\] which would mean \\[\n  a^2+b^2\\equiv_2 1+1\\equiv_2 2\\equiv_2 0,\n\\] and therefore \\(n\\equiv_2 0\\), which is impossible since \\(n\\) is odd.\nSimilarly, if \\(a\\) and \\(b\\) are both even, then \\(a^2+b^2\\equiv_2 0\\), which is again impossible.\nTherefore, one is odd and one is even. Call \\(a\\) the odd one and \\(b\\) the even one. We have \\[\n  a\\equiv_2 1,\\qquad b\\equiv_2 0.\n\\]\nSince \\(b\\) is even, when we divide \\(b\\) by \\(4\\) we get either remainder \\(0\\) or remainder \\(2\\) (otherwise it would be odd). So \\[\n  b\\equiv_4 0 \\quad\\text{or}\\quad b\\equiv_4 2.\n\\] In both cases we get \\[\n  b^2\\equiv_4 0.\n\\]\nSimilarly, since \\(a\\) is odd, we have \\[\n  a\\equiv_4 1 \\quad\\text{or}\\quad a\\equiv_4 3.\n\\] In both cases (check!) we get \\[\n  a^2\\equiv_4 1.\n\\]\nTherefore \\[\n  a^2+b^2\\equiv_4 1+0\\equiv_4 1,\n\\] which means \\[\n  n\\equiv_4 1.\n\\]"
  },
  {
    "objectID": "posts/fermat-christmas-theorem/integer-congruences/integer-congruences.html#invertible-numbers-modulo-q",
    "href": "posts/fermat-christmas-theorem/integer-congruences/integer-congruences.html#invertible-numbers-modulo-q",
    "title": "Some basic modular arithmetic",
    "section": "Invertible numbers modulo \\(q\\)",
    "text": "Invertible numbers modulo \\(q\\)\nRecall what the greatest common divisor is:\n\nDefinition: Let \\(n\\) and \\(m\\) be two integers different from \\(0\\). The greatest common divisor \\(\\gcd(n,m)\\) is the product of the common primes appearing in the factorizations of \\(n\\) and \\(m\\), taken with the least power.\n\n\nExample 2 We compute the greatest common divisor between \\(72\\) and \\(540\\). We have \\[\n  72=2^3\\cdot 3^2,\\qquad 540=2^2\\cdot 3^3\\cdot 5,\n\\] therefore \\[\n  \\gcd(72,540)=2^2\\cdot 3^2.\n\\]\n\nSuppose we have two integers \\(n\\) and \\(q\\) with \\(q&gt;0\\). We ask when there exists another integer \\(m\\) such that \\[\n  n\\cdot m\\equiv_q 1.\n\\] Let’s try a few examples:\n\nIf \\(n=4\\) and \\(q=7\\), then \\[\n  4\\cdot 2\\equiv_7 1.\n\\]\nIf \\(n=4\\) and \\(q=6\\), then we cannot find any such \\(m\\).\nIf \\(n=3\\) and \\(q=9\\), we cannot find any such \\(m\\).\nIf \\(n=3\\) and \\(q=5\\), then \\[\n  3\\cdot 2\\equiv_5 1.\n\\]\n\nTry some examples yourself.\n\nDefinition: Let \\(n\\) and \\(q\\) be integers with \\(q&gt;0\\). We say that \\(n\\) is invertible modulo \\(q\\) if there exists an integer \\(m\\) such that \\[\n  n\\cdot m\\equiv_q 1.\n\\]\n\nThe answer to the question is given by the following proposition.\n\nProposition 4 Let \\(n\\) and \\(q\\) be integers with \\(q&gt;0\\). Then \\(n\\) is invertible modulo \\(q\\) if and only if \\(\\gcd(n,q)=1\\)."
  },
  {
    "objectID": "posts/fermat-christmas-theorem/integer-congruences/integer-congruences.html#chinese-remainder-theorem",
    "href": "posts/fermat-christmas-theorem/integer-congruences/integer-congruences.html#chinese-remainder-theorem",
    "title": "Some basic modular arithmetic",
    "section": "Chinese Remainder Theorem",
    "text": "Chinese Remainder Theorem\nWe now state the theorem that will let us solve our bus problem efficiently.\n\nTheorem 1 Let \\(s,t&gt;1\\) be integers with \\(\\gcd(s,t)=1\\). Then for all integers \\(a\\) and \\(b\\) there exists an integer \\(x\\) such that \\[\n  x\\equiv_s a\n  \\qquad\\text{and}\\qquad\n  x\\equiv_t b.\n\\]\n\n\nProof. We want \\[\n  x\\equiv_s a\n  \\qquad\\text{and}\\qquad\n  x\\equiv_t b.\n\\] The first congruence \\(x\\equiv_s a\\) means that \\(x-a\\) is divisible by \\(s\\), hence \\(x\\) is of the form \\[\n  x = a + s\\cdot n\n\\] for some integer \\(n\\).\nNow we impose the second congruence. We want \\(x\\equiv_t b\\), i.e. \\[\n  a+s\\cdot n \\equiv_t b.\n\\] Subtract \\(a\\) from both sides: \\[\n  s\\cdot n \\equiv_t b-a.\n\\] So the whole problem becomes: can we solve \\[\n  s\\cdot n \\equiv_t (b-a)?\n\\]\nSince \\(\\gcd(s,t)=1\\), by Proposition 4 the number \\(s\\) is invertible modulo \\(t\\). This means that there exists an integer \\(u\\) such that \\[\n  s\\cdot u \\equiv_t 1.\n\\] Now multiply the congruence \\(s\\cdot n \\equiv_t (b-a)\\) by \\(u\\): \\[\n  (s\\cdot u)\\cdot n \\equiv_t u\\cdot (b-a).\n\\] But \\(s\\cdot u\\equiv_t 1\\), so the left-hand side becomes \\[\n  1\\cdot n \\equiv_t u(b-a),\n\\] that is, \\[\n  n \\equiv_t u(b-a).\n\\] Therefore, if we choose \\(n:=u(b-a)\\), we get our solution, which is \\[\n  x=a+s\\cdot u(b-a).\n\\]\n\n\nRemark 3. Observe that Theorem 1 tells us about the existence of a solution. However, in general the solution is not unique. Indeed, suppose that we have a solution \\(x\\). Then also \\(x+st\\) is a solution, because \\[\n  x+st\\equiv_s x,\\qquad x+st\\equiv_t x.\n\\] In particular, after having found a solution \\(x\\), all the other solutions are of the form \\(x+st\\cdot k\\) with \\(k\\) an integer."
  },
  {
    "objectID": "posts/fermat-christmas-theorem/introduction/introduction.html",
    "href": "posts/fermat-christmas-theorem/introduction/introduction.html",
    "title": "Introduction to Fermat’s Christmas Theorem",
    "section": "",
    "text": "ENG ITA\n\n\nSome history\nOn Christmas day (25 December 1640), Pierre de Fermat wrote a letter to Marin Mersenne where he stated that every prime number of the form \\(4n+1\\) could be written as the sum of two squares. He claimed to have an irrefutable proof of the statement.\nThe result was already conjectured by Albert Girard, but the first complete proof was given by Leonhard Euler, who announced it in a letter sent to Christian Goldbach.\nToday the theorem is known as “Fermat’s theorem on sums of two squares” or “Fermat’s Christmas Theorem”, because of the date in which Fermat claimed to have the proof.\nDetailed historical information can be found in the relevant chapter of Dickinson (1938).\n\n\n\nRandom thoughts sometimes are nice\nWe’re bored, so we start writing some useless calculations in our notebook. We really like prime numbers (we’ll explain why later in the posts), so we start by writing a few of them:\n\\[\n   2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41 \\dots\n\\tag{1}\\]\nSince we have nothing better to do, we start asking some questions about them, like:\n\nhow many prime numbers are there?\nwhich numbers could be expressed as the product of prime numbers?\n\nWe like these questions (and will answer them in the next few posts), but in the process we ask a more subtle one:\n\nQuestion: When can we write a prime number \\(p\\) as the sum of two squares? In other words, when can we write \\[\n    p=a^2+b^2\n\\] with \\(a\\) and \\(b\\) are integers?\n\nWe try to approach the problem by trial and error to understand it better.\n\nConsider the prime number \\(2\\). Can we write it as the sum of two squares? Well, there aren’t many ways to write \\(2\\) as a sum of two integers: \\[\n  2=1+1\n\\] But since \\(1^2=1\\) we have \\[\n  2=1^2+1^2\n\\] therefore we can indeed write \\(2\\) as the sum of two squares.\nLet’s try with \\(3\\): the only possible ways of writing \\(3\\) as a sum of two numbers are \\(3=1+2\\) and \\(3=0+3.\\) However \\(2\\) and \\(3\\) are not squares, so \\(3\\) does not have the property.\nWe move on to the number \\(5\\): we can write it as \\(5=2+3\\), but since \\(2\\) and \\(3\\) are not squares, we have to search for another writing, that we find in \\(5=4+1\\), since \\(4=2^2\\) and \\(1=1^2\\). \\[\n  5=1^2+2^2.\n\\]\nWhat about \\(7\\)? Well, we can write \\(7\\) as:\n\n\\(7=0+7\\), but \\(7\\) is not a square;\n\\(7=1+6\\), but \\(6\\) is not a square;\n\\(7=2+5\\), but neither \\(2\\) nor \\(5\\) are squares;\n\\(7=3+4\\), but \\(3\\) is not a square. therefore \\(7\\) cannot be written as the sum of two squares.\n\n\nContinuing this process, we find that among the primes in the list above, those that satisfy the property are:\n\\[\n2, 5, 13, 17, 29, 37, 41 \\dots\n\\tag{2}\\]\nWe want to investigate further the properties of these primes. First, observe that we are only interested in odd primes (i.e., all primes other than \\(2\\)), since we already know that \\(2\\) can be written as the sum of two squares. Therefore, we start to look at them carefully and conjecture the following fact:\n\nAll odd primes that can be written as the sum of two squares have remainder \\(1\\) when divided by \\(4\\).\n\nHowever, this only tells us that if an odd prime is a sum of two squares, then it leaves remainder \\(1\\) when divided by \\(4\\). But in general it’s not easy to check whether a prime is the sum of two squares, since we’d have to try many possibilities (look at \\(7\\) and imagine larger primes). If we just want to know whether a prime has remainder \\(1\\) when divided by \\(4\\), we can compute that quickly and save time.\nBut maybe we didn’t waste our time thinking about this problem. Since we can easily check what is the remainder of a prime when divided by \\(4\\), what if we can write an odd prime as the sum of two squares each time it has remainder \\(1\\) in such a division? That would be great: we could avoid long case checks and simply compute the remainder, like we learned in elementary school. Luckily, the theorem we want to focus on gives us the answer:\n\nTheorem 1 (Fermat’s Christmas Theorem) An odd prime number \\(p\\) can be written as the sum of two squares if and only if it has remainder \\(1\\) when divided by \\(4\\).\n\nNow we see why the theorem is nice: it simplifies a difficult problem (determining whether an odd prime is the sum of two squares) to a simple one (checking whether its remainder is \\(1\\) when divided by \\(4\\)).\nIn the next posts we will develop the necessary tools step by step, until we can give a complete proof of Fermat’s Christmas Theorem.\n\n\nSome plan for the future\nI chose to talk about this theorem because, to me, the most interesting part is its proof. As a math student I spend most of my time trying to understand proofs (for me, mathematics is mostly about them).\nMaybe some of you are asking yourselves:\n\nWhat is a mathematical proof?\n\nThis isn’t an easy question (it’s rather philosophical). Anyway, we can think of a proof as an argument convincing us about the truth of some proposition. Probably not all the arguments I share will be full formal proofs, since I won’t always be very formal. My goal is to convey the general ideas rather than the technical details. I hope the careful reader will forgive me if I sometimes prefer simplicity to rigor.\nThe aim is to help interested readers convince themselves of Fermat’s Christmas Theorem and to explain some basic mathematical ideas along the way.\nA rough plan for the proof will involve:\n\ntalking about general properties of integers\ntalking about modular arithmetic\ntalking about Gaussian integers\nputting everything together\n\nI hope you enjoy the process as much as I did the first time I learned these beautiful ideas.\n\nSee you soon!\n\n\nThis article is part of the series Fermat’s Christmas Theorem.\n\n\nNext: How many primes are there?\n\n\n\n\n\n\n\nReferences\n\nDickinson, L. J. 1938. History of the Theory of Numbers. New York: Chelsea Publishing Company."
  },
  {
    "objectID": "posts/fermat-christmas-theorem/howmanyprimes/how-many-primes.html",
    "href": "posts/fermat-christmas-theorem/howmanyprimes/how-many-primes.html",
    "title": "How many primes are there?",
    "section": "",
    "text": "ENG ITA"
  },
  {
    "objectID": "posts/fermat-christmas-theorem/howmanyprimes/how-many-primes.html#what-a-prime-is",
    "href": "posts/fermat-christmas-theorem/howmanyprimes/how-many-primes.html#what-a-prime-is",
    "title": "How many primes are there?",
    "section": "What a prime is?",
    "text": "What a prime is?\nLet’s start with a short recap. In school we learned that a positive integer is prime if its only divisors are \\(1\\) and itself (\\(1\\) is not considered prime). So we have that \\(2,3,5,\\dots\\) are the first few primes.\nConsider the prime \\(2\\). Note that every time \\(2\\) divides a product of two integers \\(a\\cdot b\\), it divides one of the two factors (i.e. either \\(2\\) divides \\(a\\) or \\(2\\) divides \\(b\\)). Try a few examples to convince yourself. For instance, \\(2\\) divides the product \\(4\\cdot 5=20\\) and indeed \\(2\\) divides \\(4\\). You can try any product and the property will hold. There is nothing special about \\(2\\); indeed, every prime number satisfies this (i.e. if a prime number \\(p\\) divides a product \\(a\\cdot b\\) then either \\(p\\) divides \\(a\\) or \\(p\\) divides \\(b\\)). Note that this property characterises primes. For example, observe that \\(6\\) (which isn’t prime) divides the product \\(3\\cdot 4=12\\), but \\(6\\) divides neither \\(3\\) nor \\(4\\).\nSince this property is important, we define prime numbers as follows:\n\nDefinition: An integer \\(p\\) is prime if whenever \\(p\\) divides a product \\(a\\cdot b\\), then \\(p\\) divides \\(a\\) or \\(p\\) divides \\(b\\).\n\nWe will instead use the term irreducible for the other definition we know:\n\nDefinition: An integer \\(q\\) is irreducible if its only divisors are itself,\\(1\\), and \\(-1\\).\n\nWe include \\(-1\\) because we allow negative integers; for instance \\(-3\\) is irreducible since its only divisors are \\(-1\\), \\(1\\), and \\(-3\\).\nFor integers, a number is irreducible if and only if it is prime, so the two definitions agree. This is why we often use the irreducible definition for primes."
  },
  {
    "objectID": "posts/fermat-christmas-theorem/index.html",
    "href": "posts/fermat-christmas-theorem/index.html",
    "title": "Fermat’s Christmas Theorem – series index",
    "section": "",
    "text": "Introduction to Fermat’s Christmas Theorem\n\n\nFermat’s Christmas Theorem series\n\n\nWe introduce Fermat’s Christmas Theorem and try to understand its meaning through concrete examples.\n\n\n\n\n\nNov 29, 2025\n\n\n\n\n\n\n\n\n\n\n\n\nHow many primes are there?\n\n\nFermat’s Christmas Theorem series\n\n\nExpository tour of Euclid’s proof that there are infinitely many primes, preceded by a discussion of Euclidean division and the fundamental theorem of arithmetic.\n\n\n\n\n\nDec 8, 2025\n\n\n\n\n\n\n\n\n\n\n\n\nSome basic modular arithmetic\n\n\nFermat’s Christmas Theorem series\n\n\nWe introduce modular arithmetic and understand the meaning of Chinese Remainder Theorem.\n\n\n\n\n\nDec 14, 2025\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/interesting-facts/ax-grothendieck/ax-grothendieck.html",
    "href": "posts/interesting-facts/ax-grothendieck/ax-grothendieck.html",
    "title": "Ax–Grothendieck Theorem",
    "section": "",
    "text": "Introduction\nWe all know from basic linear algebra that injective endomorphisms of a finite-dimensional vector space are also surjective. The same holds for finite sets. Over algebraically closed fields, there is an analogous result:\n\nTheorem 1 (Special case of Ax–Grothendieck Theorem) Let \\(k\\) be an algebraically closed field, \\(n\\in \\mathbb{N}\\), and \\(f_1,\\dots,f_n\\in k[x_1,\\dots ,x_n]\\). If the map \\[\nF:k^n \\rightarrow k^n, \\qquad F(\\underline{x})=(f_1(\\underline{x}),\\dots, f_n(\\underline{x}))\n\\] is injective, then it is surjective.\n\nWe will talk about an analogous and more general statement about schemes later on.\nLet us comment briefly on the hypotheses. Injectivity is the correct assumption for \\(F\\): the map \\(z\\mapsto z^2\\) is surjective but not injective on \\(\\mathbb{C}\\). Furthermore, the result is generally false for non-algebraically closed fields; for example, \\(x \\mapsto x^3\\) is injective but not surjective on \\(\\mathbb{Q}\\).\nAs a sanity check, let’s verify the result for \\(n=1\\). Consider a polynomial \\(f\\in k[x]\\) such that the map \\(x\\mapsto f(x)\\) is injective; then \\(f\\) can have at most one root. Since \\(k\\) is algebraically closed, it follows that \\(f=ax+b\\) with \\(a\\neq 0\\) (otherwise the map would not be injective). Hence \\(f\\) is surjective.\nMoreover, the theorem is easy to prove when \\(k=\\overline{\\mathbb{F}}_p\\).\n\nProof (For \\(k=\\overline{\\mathbb{F}}_p\\)). Let \\(\\underline z:=(z_1,\\dots, z_n)\\in k^n\\) and let \\(L\\) be the subfield of \\(k\\) generated by the coefficients of the polynomials defining \\(F\\) and by the \\(z_i\\)’s. The field \\(L\\) is a finite extension of \\(\\mathbb{F}_p\\), hence a finite set. The restriction \\(F:L^n\\rightarrow L^n\\) is well-defined and injective; since \\(L^n\\) is finite it is also surjective. Therefore, \\(\\underline z\\) lies in the image of \\(F\\), proving the claim.\n\n\n\n\nProof of the theorem\nWe start by proving two lemmas and then proceed with the proof of Theorem 1.\n\nLemma 1 The map \\(F\\) is injective if and only if there exist \\(q_{i,j}\\in k[x_1,\\dots,x_n,y_1,\\dots,y_n]\\) and integers \\(k_j&gt;0\\) such that, defining \\[\ng_i(x_1,\\dots, x_n,y_1,\\dots,y_n)\n:=f_i(x_1,\\dots , x_n)-f_i(y_1,\\dots,y_n),\n\\] for all \\(j\\) we have the identity \\[\n\\sum_{i=1}^n g_i\\cdot q_{i,j}=(x_j-y_j)^{k_j}\n\\tag{1}\\]\n\n\nProof. Consider the ideal \\(I=(g_1,\\dots, g_n)\\). The map \\(F\\) is injective if and only if all the zeros of \\(I\\) are of the form \\((\\underline{x},\\underline{x})\\) for \\(\\underline{x}\\in k^n\\). This is the case if and only if the zeros of \\(I\\) are a subset of the zeros of \\(J=(x_1-y_1,\\dots,x_n-y_n)\\), i.e. if and only if \\(\\mathrm{V}(I) \\subseteq \\mathrm{V}(J)\\). By the Hilbert Nullstellensatz, this holds if and only if \\(J \\subseteq \\sqrt I\\); hence \\((x_j-y_j)\\in \\sqrt{I}\\).\n\n\nLemma 2 Let \\(\\underline{z}\\in k^n\\). Then \\(\\underline z\\) is not in the image of \\(F\\) if and only if there exist \\(r_1,\\dots ,r_n\\in k[x_1,\\dots ,x_n]\\) such that \\[\n\\sum_{i=1}^n r_i\\cdot (f_i-z_i)=1.\n\\tag{2}\\]\n\n\nProof. The element \\(\\underline{z}\\) is not in the image of \\(F\\) if and only if the ideal \\(I=(f_1-z_1,\\dots,f_n-z_n)\\) has no zeros, equivalently \\(1\\in I\\) (again by Nullstellensatz).\n\nNow we are ready to prove the theorem.\n\nProof (Of Theorem 1). Suppose \\(\\underline{z}\\in k^n\\) is not in the image of \\(F\\). Let \\(A\\) be the \\(\\mathbb{Z}\\)-algebra generated by:\n\nthe coefficients of the \\(f_i\\)’s defining \\(F\\);\nthe \\(z_i\\)’s;\nthe coefficients of the \\(q_{i,j}\\) as in Lemma 1;\nthe coefficients of the \\(r_i\\) as in Lemma 2.\n\nSince finitely many coefficients are involved, \\(A\\) is of finite type over \\(\\mathbb{Z}\\). Moreover, the restriction \\(F:A^n \\rightarrow A^n\\) is still injective. Furthermore, we have the following identities in \\(A[x_1,\\dots,x_n,y_1,\\dots,y_n]\\) given respectively by Lemma 1 and Lemma 2: \\[\n\\sum_{i=1}^n g_i\\cdot q_{i,j}=(x_j-y_j)^{k_j}\n\\tag{3}\\]\n\\[\n\\sum_{i=1}^n r_i\\cdot (f_i-z_i)=1\n\\tag{4}\\]\nNow pick a maximal ideal \\(m\\) in \\(A\\). The field \\(A/m\\) is finite by the following claim.\n\n\nClaim: Let \\(B\\) be an algebra of finite type over \\(\\mathbb{Z}\\). If \\(m\\) is a maximal ideal of \\(B\\), then \\(B/m\\) is a finite field.\n\nAssuming the claim, set \\(L=A/m\\) and note that the reduction \\(\\overline{F}:L^n\\rightarrow L^n\\) of \\(F\\) modulo \\(m\\) is injective. Indeed, consider \\(\\underline x,\\underline y\\in L^n\\) such that \\(\\overline{F}(\\underline x)=\\overline{F}(\\underline y)\\). By evaluating Equation 3 at \\((\\underline x,\\underline y)\\) we obtain \\(\\underline x=\\underline y\\) in \\(L^n\\), since \\(\\overline g_i(\\underline x, \\underline y)=0\\) for all \\(i\\).\nSince \\(L^n\\) is finite and \\(\\overline{F}\\) is injective, \\(\\overline F\\) is surjective. However, reducing \\(\\underline{z}\\) modulo \\(m\\) and evaluating Equation 4 at a preimage of that reduction under \\(\\overline F\\) yields a contradiction. Hence, up to proving the claim, we have established Theorem 1.\n\nProof (of the Claim). Consider two cases:\n\nIf \\(m\\cap \\mathbb{Z}=p \\mathbb{Z}\\), then \\(B/m\\) is an algebra of finite type over \\(\\mathbb{F}_p\\); by Zariski’s lemma \\(B/m\\) is a finite extension of \\(\\mathbb{F}_p\\), hence finite.\nIf \\(m\\cap \\mathbb{Z}=0\\), then in the tower \\(\\mathbb{Z} \\subset \\mathbb{Q} \\subset B/m\\), we see that \\(B/m\\) is of finite type over \\(\\mathbb{Q}\\), hence is finite over \\(\\mathbb{Q}\\) by Zariski’s lemma. Artin–Tate’s lemma then implies that \\(\\mathbb{Q}\\) would be of finite type over \\(\\mathbb{Z}\\), a contradiction.\n\n\n\n\n\n\nGeneralization to schemes\nNote that the map \\(F\\) considered in Theorem 1 can be seen as the map induced on closed points by a morphism of \\(k\\)-schemes \\(\\mathbb{A}^n_k\\rightarrow \\mathbb{A}^n_k\\). This leads to the following question:\n\nQuestion:\nLet \\(k\\) be an algebraically closed field and \\(X\\) a scheme of finite type over \\(k\\). If \\(f:X\\rightarrow X\\) is a \\(k\\)-endomorphism injective on \\(k\\)-points, is it surjective on all points?\n\nThe finite-type assumption is necessary: the map induced by \\[\nk[X_1,\\dots, X_n,\\dots]\\to k[X_1,\\dots, X_n,\\dots]\n\\] sending \\(X_1\\mapsto 0\\) and \\(X_i\\mapsto X_{i-1}\\) for \\(i&gt;1\\) is injective but not surjective.\nThe answer is positive, and it follows (not trivially) from the following theorem.\n\nTheorem 2 (Ax–Grothendieck Theorem) Let \\(S\\) be a scheme and let \\(X\\) be a scheme of finite type over \\(S\\). Any injective \\(S\\)-endomorphism \\(f:X\\rightarrow X\\) is bijective.\n\nMoreover, if \\(X\\) is reduced and \\(k\\) is an algebraically closed field of characteristic \\(0\\), then an injective endomorphism on \\(k\\)-points is in fact an isomorphism (not merely a bijection). This is not trivial since we have bijective morphisms of schemes that are not isomorphisms (for example the one induced by \\(k[t^2,t^3]\\rightarrow k[t]\\)). A reference for this is Lemma 1 of this article.\nWe will not give a proof of Theorem 2; see J. Ax’s paper Injective endomorphisms of varieties and schemes, or Grothendieck’s version in EGA IV\\(_3\\), Proposition 10.4.11 for a complete proof.\nLet us explain why Theorem 2 implies that injectivity on \\(k\\)-points gives surjectivity on all points.\nThe first ingredient is Chevalley’s theorem on constructible sets (see Hartshorne, Ex. II.3.19).\n\nTheorem 3 (Chevalley’s theorem) Let \\(f:X\\to Y\\) be a finite type morphism between noetherian schemes. If \\(Z \\subseteq X\\) is a constructible subset (i.e. a finite union of locally closed subsets), then \\(f(Z)\\) is constructible.\n\nThe following lemma explains why Theorem 2 implies Theorem 1.\n\nLemma 3 Let \\(X, Y\\) be schemes of finite type over an algebraically closed field \\(k\\). Let \\(f:X\\to Y\\) be a morphism whose restriction to \\(k\\)-points \\[\nf: X(k)\\to Y(k)\n\\] is injective. Then \\(f\\) is universally injective.\n\nAssuming this lemma, consider a morphism \\(f:\\mathbb{A}^n_k\\to \\mathbb{A}^n_k\\) over \\(k\\) which is injective on closed points (which are exactly the \\(k\\)-points, since \\(k\\) is algebraically closed). Then in particular \\(f\\) is injective on all points. From Theorem 2 we get the surjectivity of \\(f\\) on all points (answering the question raised before) and in particular also surjectivity on closed points, since only closed points are sent to closed points. In particular, we obtain Theorem 1.\n\nProof (Of Lemma 3). Observe that the diagonal \\(\\Delta_f:X\\to X\\times_Y X\\) is of finite type. Indeed, it is locally of finite type because \\(X\\to \\mathrm{Spec}(k)\\) is locally of finite type (and \\(\\Delta_f\\) can be seen as the first factor of this map), and it is quasi-compact because \\(X\\) is noetherian (being of finite type over \\(k\\)).\nMoreover, the diagonal \\(\\Delta_f\\) is surjective on \\(k\\)-points. Indeed, for any \\(k\\)-point of \\(X\\times_Y X\\) given by a morphism \\[\n\\psi: \\mathrm{Spec}(k)\\to X\\times_Y X\n\\] we can consider the diagram\n\n\n\nand by injectivity of the morphism \\(X\\to Y\\) we obtain \\(\\phi_1=\\phi_2\\) as maps of topological spaces. They are also the same on the structure sheaf, because \\(k\\) is algebraically closed. Therefore, \\(\\phi_1=\\phi_2\\), which means that \\(\\psi\\) factorizes through the diagonal \\(\\Delta_f\\).\nFurthermore, \\(X\\times _Y X\\) is a Jacobson scheme (i.e. its underlying topological space is Jacobson) because it is of finite type over \\(k\\), and \\(k\\) is Jacobson. By Theorem 3 the set \\(\\Delta_f(X)\\) is constructible. Consider \\(Z:=(X\\times_Y X)\\smallsetminus \\Delta_f(X)\\). This is constructible and every closed point of \\(X\\times_Y X\\) lies inside \\(\\Delta_f(X)\\) (by surjectivity of \\(\\Delta_f\\) on closed points). Since every nonempty constructible subset in a Jacobson scheme contains a closed point, it follows that \\(Z=\\emptyset\\). Therefore, \\(\\Delta_f\\) is surjective on all points.\nNow we prove that the surjectivity of \\(\\Delta_f\\) implies the universal injectivity of \\(f\\). Indeed, consider any \\(g: Z\\to Y\\) and the diagonal \\[\n\\Delta: X\\times_Y Z\\to (X\\times_Y Z)\\times_Z(X\\times_Y Z)\n\\] of the base change. This diagonal map \\(\\Delta\\) is surjective because it is the base change of \\(\\Delta_f\\), which is surjective. Thus, we are reduced to proving that surjectivity of \\(\\Delta_f\\) implies injectivity of \\(f\\) (the same will then hold for any base change).\nConsider \\(x_1,x_2\\in X\\) with \\(f(x_1)=f(x_2)=:y\\). We can find a field \\(L\\) such that the following diagram commutes:\n\n\n\nWe get the following commutative diagram:  \nBy surjectivity of \\(\\Delta_f\\) we can find \\(x\\in X\\) such that \\(\\Delta_f(x)\\) is the image of \\(\\epsilon\\), hence we get \\(x_1=x_2\\). This shows that \\(f\\) is injective, and therefore universally injective.\n\nNote that the complex-geometric picture does not match the algebraic one. For example, there are holomorphic maps \\(\\mathbb{C}^n\\rightarrow \\mathbb{C}^n\\) that are injective but not surjective. However, this cannot happen for \\(n=1\\), as one can show that all holomorphic injective maps \\(f: \\mathbb{C}\\rightarrow \\mathbb{C}\\) are of the form \\(f=ax+b\\); see the Casorati–Weierstrass theorem.\n\n\n\nConclusion\nTo conclude, we point your attention to the fact that this theorem is linked to a famous conjecture, namely the Jacobian conjecture.\n\nConjecture 1 (Jacobian conjecture) Let \\(k\\) be a field of characteristic \\(0\\) and let \\(F: k^n\\to k^n\\) be a polynomial mapping. If the Jacobian determinant \\(J_F\\) is invertible, then \\(F\\) is an isomorphism.\n\nOver an algebraically closed field of characteristic \\(0\\), the fact that the bijection in Theorem 2 becomes an isomorphism shows that, to prove the Jacobian conjecture for \\(\\mathbb{A}^n_k\\), it suffices to show that a map \\[\nF:\\mathbb{A}^n_k\\rightarrow \\mathbb{A}^n_k\n\\] with invertible Jacobian determinant is injective.\n\nI would like to thank my friend who suggested this topic to me and helped me write this post.\n\n\n\nReferences\nThis post was mainly inspired by this post from Terence Tao’s blog. Other references are cited in the text when used."
  },
  {
    "objectID": "posts/interesting-facts/why-fermat-had-no-proof/why-fermat-had-no-proof.html",
    "href": "posts/interesting-facts/why-fermat-had-no-proof/why-fermat-had-no-proof.html",
    "title": "Why Fermat had (probably) no proof?",
    "section": "",
    "text": "According to Dickinson (1938), Fermat stated the following in 1637:\n\nIt is impossible to separate a cube into two cubes, or a biquadrate into two biquadrates, or in general any power higher than the second into the power of like degree; I have discovered a truly remarkable proof which this margin is too small to contain.”\n\nThis theorem is now known as Fermat’s Last Theorem, and it can be stated as follows.\n\nTheorem 1 (Fermat’s last theorem) Let \\(n\\geq 3\\) be an integer. The equation \\[\nx^n+y^n=z^n\n\\] has no non-trivial solutions \\(x,y,z\\in \\mathbb{Z}\\).\n\nFirst, observe that we can reduce to consider only triples \\((x,y,z)\\in \\mathbb{Z}^3\\) with \\(\\gcd(x,y,z)=1\\). In particular, in this situation \\(x,y,z\\) are pairwise coprime: for instance, if a prime \\(\\ell\\) divides \\(x\\) and \\(z\\), then it divides \\(z^q-x^q=y^q\\), hence it divides \\(y\\), contradicting \\(\\gcd(x,y,z)=1\\). Moreover, Fermat himself proved the theorem in the case \\(n=4\\); therefore, using basic properties of powers, it is enough to prove the theorem for \\(n=q\\), where \\(q\\) is an odd prime.\nTo prove Theorem 1, we could naively proceed in the following way. Fix an odd prime \\(q\\geq 3\\) and suppose that we had a non-trivial solution \\(x,y,z\\in \\mathbb{Z}\\) of \\[\nx^q+y^q=z^q\n\\tag{1}\\] Then, reducing this equation modulo every prime \\(p\\) such that \\(p\\nmid xyz\\), we get a non-trivial solution modulo \\(p\\). Therefore, only finitely many primes \\(p\\) can fail to admit a non-trivial solution modulo \\(p\\). If we proved that for infinitely many primes \\(p\\) the reduction of Equation 1 modulo \\(p\\) has no non-trivial solution, then we would conclude that Equation 1 has no integer solutions at all.\nWe will prove that this method cannot work. Indeed, we have the following.\n\nTheorem 2 There exists an integer \\(N\\geq q\\) such that for every prime \\(p&gt;N\\), Equation 1 has a non-trivial solution in \\(\\mathbb{F}_p\\).\n\nTherefore, there are only finitely many primes with no non-trivial solution, which proves that the method cannot work.\n\n\n\nProposition 1 Fix a prime \\(q\\). There are infinitely many primes \\(p\\) such that \\(2\\) has a \\(q\\)-th root in \\(\\mathbb{F}_p\\).\n\nFrom this proposition we obtain that the equation \\(x^q+y^q=z^q\\) has a non-trivial solution modulo \\(p\\) for infinitely many primes \\(p\\). Indeed, if \\(z^q=2\\) in \\(\\mathbb{F}_p\\), we can choose \\(x=y=1\\) and get \\[\n1^q+1^q=z^q.\n\\]\n\nProof (of Proposition 1). This proposition is an easy corollary of Corollary 5 you can find in a previous post about the Chebotarev density theorem, applied to the algebra \\(A:=\\mathbb{Z}[X]/(X^q-2)\\).\n\n\nRemark 1. Observe that the Chebotarev density theorem only tells us that we find infinitely many primes giving a solution to the equation, but it also tells us that the set of primes we find has density less than \\(1\\). Therefore, it is not sufficient to establish what we want."
  },
  {
    "objectID": "posts/interesting-facts/why-fermat-had-no-proof/why-fermat-had-no-proof.html#warm-up-a-special-case",
    "href": "posts/interesting-facts/why-fermat-had-no-proof/why-fermat-had-no-proof.html#warm-up-a-special-case",
    "title": "Why Fermat had (probably) no proof?",
    "section": "",
    "text": "Proposition 1 Fix a prime \\(q\\). There are infinitely many primes \\(p\\) such that \\(2\\) has a \\(q\\)-th root in \\(\\mathbb{F}_p\\).\n\nFrom this proposition we obtain that the equation \\(x^q+y^q=z^q\\) has a non-trivial solution modulo \\(p\\) for infinitely many primes \\(p\\). Indeed, if \\(z^q=2\\) in \\(\\mathbb{F}_p\\), we can choose \\(x=y=1\\) and get \\[\n1^q+1^q=z^q.\n\\]\n\nProof (of Proposition 1). This proposition is an easy corollary of Corollary 5 you can find in a previous post about the Chebotarev density theorem, applied to the algebra \\(A:=\\mathbb{Z}[X]/(X^q-2)\\).\n\n\nRemark 1. Observe that the Chebotarev density theorem only tells us that we find infinitely many primes giving a solution to the equation, but it also tells us that the set of primes we find has density less than \\(1\\). Therefore, it is not sufficient to establish what we want."
  },
  {
    "objectID": "posts/interesting-facts/why-fermat-had-no-proof/why-fermat-had-no-proof.html#extending-to-p-adic-solutions",
    "href": "posts/interesting-facts/why-fermat-had-no-proof/why-fermat-had-no-proof.html#extending-to-p-adic-solutions",
    "title": "Why Fermat had (probably) no proof?",
    "section": "Extending to \\(p\\)-adic solutions",
    "text": "Extending to \\(p\\)-adic solutions\nWe can extend the theorem thanks to Hensel’s lemma. In particular, we can say the following.\n\nTheorem 4 (Extension of Theorem 2) There exists an integer \\(N\\geq q\\) such that for every prime \\(p&gt;N\\), the Fermat equation (Equation 1) has a non-trivial solution in \\((\\mathbb{Z}_p)^\\times\\).\n\nFrom Theorem 4 we get, in particular, a non-trivial solution in every \\(\\mathbb{Z}/p^r\\mathbb{Z}\\) for every \\(r\\geq 1\\) and for every prime \\(p&gt;N\\).\nSince we can factorize every integer as a product of primes, this tells us that if \\(m\\) is an integer having at least one prime divisor \\(&gt;N\\), then \\(x^q+y^q=z^q\\) has a non-trivial solution in \\(\\mathbb{Z}/m \\mathbb{Z}\\).\n\nProof (of Theorem 4). Fix a prime \\(p&gt;N\\). From Theorem 2 we know that there is a solution \\((\\overline a,\\overline b,\\overline c)\\in(\\mathbb{F}_p^\\times)^3\\) such that \\[\n\\overline a^q+\\overline b^q=\\overline c^q \\quad\\text{in }\\mathbb{F}_p.\n\\] Choose lifts \\(a,b,c_0\\in \\mathbb{Z}_p^\\times\\) such that \\(a\\equiv \\overline a\\), \\(b\\equiv \\overline b\\), \\(c_0\\equiv \\overline c \\pmod p\\). Define the polynomial \\(g(T):=a^q+b^q-T^q\\in \\mathbb{Z}_p[T]\\).\nThen\n\n\\(g(c_0)\\equiv 0 \\pmod p\\);\n\\(g'(T)=-qT^{q-1}\\), so \\(g'(c_0)\\equiv -q\\overline c^{\\,q-1}\\not \\equiv 0 \\pmod p\\) (since \\(p\\neq q\\) and \\(\\overline c\\neq 0\\)).\n\nBy Hensel’s lemma there is a unique \\(c\\in \\mathbb{Z}_p\\) such that \\(c\\equiv c_0 \\pmod p\\) and such that \\(c\\) is a root of \\(g\\) in \\(\\mathbb{Z}_p\\). In particular, \\[\na^q+b^q=c^q\n\\quad\\text{in }\\mathbb{Z}_p,\n\\] so \\((a,b,c)\\in(\\mathbb{Z}_p^\\times)^3\\) is a non-trivial \\(p\\)-adic solution."
  },
  {
    "objectID": "IT/fermat-christmas-theorem/introduction/introduction-IT.html",
    "href": "IT/fermat-christmas-theorem/introduction/introduction-IT.html",
    "title": "Introduzione",
    "section": "",
    "text": "ENG ITA\n\n\nUn po’ di storia\nIl giorno di Natale (25 dicembre 1640), Pierre de Fermat scrisse una lettera a Marin Mersenne in cui affermava che ogni numero primo della forma \\(4n+1\\) può essere scritto come somma di due quadrati. Dichiarò di avere una prova inoppugnabile dell’enunciato.\nIl risultato era già stato congetturato da Albert Girard, ma la prima dimostrazione completa fu data da Leonhard Euler, che la annunciò in una lettera inviata a Christian Goldbach.\nOggi il teorema è conosciuto come “Teorema di Fermat sulle somme di due quadrati” o “Teorema di Natale”, a causa della data in cui Fermat dichiarò di averne trovato la dimostrazione.\nInformazioni storiche più dettagliate si possono trovare nel capitolo corrispondente di Dickinson (1938).\n\n\n\nA volte i pensieri casuali sono piacevoli\nSiamo annoiati, quindi cominciamo a scrivere qualche calcolo inutile sul nostro quaderno. Ci piacciono molto i numeri primi (spiegheremo il perché più avanti nei post), quindi iniziamo scrivendone alcuni:\n\\[\n   2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41 \\dots\n\\tag{1}\\]\nVisto che non abbiamo niente di meglio da fare, cominciamo a porci alcune domande su di loro, ad esempio:\n\nquanti numeri primi esistono?\nquali numeri possono essere espressi come prodotto di numeri primi?\n\nQueste domande ci piacciono (e daremo loro una risposta nei prossimi post), ma nel processo ce ne poniamo una più sottile:\n\nDomanda: Quando possiamo scrivere un numero primo \\(p\\) come somma di due quadrati? In altre parole, quando possiamo scrivere \\[\n    p=a^2+b^2\n\\] con \\(a\\) e \\(b\\) interi?\n\nCerchiamo di avvicinarci al problema per tentativi, per capirlo meglio.\n\nConsideriamo il numero primo \\(2\\). Possiamo scriverlo come somma di due quadrati? Be’, non ci sono molti modi di scrivere \\(2\\) come somma di due interi: \\[\n  2=1+1\n\\] Ma poiché \\(1^2=1\\) abbiamo \\[\n  2=1^2+1^2\n\\] quindi possiamo effettivamente scrivere \\(2\\) come somma di due quadrati.\nProviamo con \\(3\\): i soli modi possibili di scrivere \\(3\\) come somma di due numeri sono \\(3=1+2\\) e \\(3=0+3.\\) Tuttavia \\(2\\) e \\(3\\) non sono quadrati, quindi \\(3\\) non ha la proprietà.\nPassiamo al numero \\(5\\): possiamo scriverlo come \\(5=2+3\\), ma siccome \\(2\\) e \\(3\\) non sono quadrati, dobbiamo cercare un’altra scrittura, che troviamo in \\(5=4+1\\), dato che \\(4=2^2\\) e \\(1=1^2\\). \\[\n  5=1^2+2^2.\n\\]\nE \\(7\\)? Possiamo scrivere \\(7\\) come:\n\n\\(7=0+7\\), ma \\(7\\) non è un quadrato;\n\\(7=1+6\\), ma \\(6\\) non è un quadrato;\n\\(7=2+5\\), ma né \\(2\\) né \\(5\\) sono quadrati;\n\\(7=3+4\\), ma \\(3\\) non è un quadrato.\n\n\nQuindi \\(7\\) non può essere scritto come somma di due quadrati.\nContinuando questo processo, troviamo che tra i primi nella lista sopra, quelli che soddisfano la proprietà sono:\n\\[\n2, 5, 13, 17, 29, 37, 41 \\dots\n\\tag{2}\\]\nVogliamo indagare meglio le proprietà di questi primi. Per prima cosa, osserviamo che ci interessano solo i primi dispari (cioè tutti i primi diversi da \\(2\\)), dato che sappiamo già che \\(2\\) può essere scritto come somma di due quadrati. Pertanto, iniziamo a guardarli con attenzione e congetturare il seguente fatto:\n\nTutti i primi dispari che possono essere scritti come somma di due quadrati hanno resto \\(1\\) quando divisi per \\(4\\).\n\nTuttavia, questo ci dice solo che se un primo dispari è una somma di due quadrati, allora lascia resto \\(1\\) quando diviso per \\(4\\). Ma in generale non è facile verificare se un primo è somma di due quadrati, perché dovremmo provare molte possibilità (guarda \\(7\\) e immagina primi più grandi). Se vogliamo soltanto sapere se un primo ha resto \\(1\\) quando diviso per \\(4\\), possiamo calcolarlo velocemente e risparmiare tempo.\nMa forse non abbiamo sprecato tempo a pensare a questo problema. Dal momento che possiamo controllare facilmente qual è il resto di un primo nella divisione per \\(4\\), cosa succede se possiamo scrivere un primo dispari come somma di due quadrati ogni volta che ha resto \\(1\\) in una tale divisione? Sarebbe ottimo: potremmo evitare lunghe verifiche caso per caso e limitarci a calcolare il resto, come abbiamo imparato alle elementari. Per fortuna, il teorema su cui vogliamo concentrarci ci dà la risposta:\n\nTheorem 1 (Fermat’s Christmas Theorem) Un numero primo dispari \\(p\\) può essere scritto come somma di due quadrati se e solo se ha resto \\(1\\) quando diviso per \\(4\\).\n\nOra capiamo perché il teorema è interessante: riduce un problema difficile (stabilire se un primo dispari è somma di due quadrati) a uno semplice (controllare se il suo resto è \\(1\\) nella divisione per \\(4\\)).\nNei prossimi post svilupperemo gli strumenti passo per passo, fino a che potremo dare una dimostrazione completa del teorema.\n\n\nQualche piano per il futuro\nHo scelto di parlare di questo teorema perché, per me, la parte più interessante è la sua dimostrazione. Come studente di matematica passo la maggior parte del mio tempo a cercare di capire dimostrazioni (per me la matematica è soprattutto questo).\nForse alcuni di voi si stanno chiedendo:\n\nChe cos’è una dimostrazione matematica?\n\nNon è una domanda semplice (è piuttosto filosofica). In ogni caso, possiamo pensare a una dimostrazione come a un argomento che ci convince della verità di una certa proposizione. Probabilmente non tutti gli argomenti che presenterò saranno dimostrazioni pienamente formali, perché non sarò sempre molto rigoroso. Il mio obiettivo è trasmettere le idee generali più che i dettagli tecnici. Spero che il lettore più attento mi perdonerà se a volte preferisco la semplicità al rigore.\nLo scopo è aiutare i lettori interessati a convincersi del Fermat’s Christmas Theorem e, lungo il percorso, spiegare alcune idee matematiche di base.\nUn possibile piano per la dimostrazione sarà:\n\nparlare di alcune proprietà generali degli interi\nparlare di aritmetica modulare\nparlare degli interi gaussiani\nmettere insieme tutti i pezzi\n\nSpero che vi godiate il percorso tanto quanto l’ho fatto io la prima volta che ho imparato queste bellissime idee.\n\nA presto!\n\n\nQuesto articolo fa parte della serie Fermat’s Christmas Theorem.\n\n\nProssimo: How many primes are there?\n\n\n\n\n\n\n\nReferences\n\nDickinson, L. J. 1938. History of the Theory of Numbers. New York: Chelsea Publishing Company."
  },
  {
    "objectID": "IT/fermat-christmas-theorem/integer-congruences/integer-congruences-IT.html",
    "href": "IT/fermat-christmas-theorem/integer-congruences/integer-congruences-IT.html",
    "title": "Aritmetica modulare di base",
    "section": "",
    "text": "ENG ITA"
  },
  {
    "objectID": "IT/fermat-christmas-theorem/integer-congruences/integer-congruences-IT.html#parte-facile-del-teorema-di-natale",
    "href": "IT/fermat-christmas-theorem/integer-congruences/integer-congruences-IT.html#parte-facile-del-teorema-di-natale",
    "title": "Aritmetica modulare di base",
    "section": "Parte facile del Teorema di Natale",
    "text": "Parte facile del Teorema di Natale\n\nProposition 3 Sia \\(n\\) un intero dispari che può essere scritto come somma di due quadrati. Allora \\(n\\equiv_4 1\\), cioè \\(n\\) ha resto \\(1\\) quando viene diviso per \\(4\\).\n\n\nRemark 2. In particolare, il teorema ci dice anche che se \\(p\\) è un primo dispari che può essere scritto come somma di due quadrati, allora ha resto \\(1\\) quando viene diviso per \\(4\\), che è parte di ciò che afferma il Teorema di Natale.\n\n\nProof. Se \\(n\\) può essere scritto come somma di due quadrati, significa che esistono interi \\(a,b\\) tali che \\[\n  n=a^2+b^2.\n\\] Osserviamo che \\(n\\) è dispari, quindi ha resto \\(1\\) quando viene diviso per \\(2\\), cioè \\[\n  n\\equiv_2 1.\n\\] Quindi \\[\n  a^2+b^2\\equiv_2 1.\n\\]\nSe sia \\(a\\) sia \\(b\\) fossero dispari, allora \\(a\\equiv_2 1\\) e \\(b\\equiv_2 1\\), quindi \\[\n  a^2\\equiv_2 1,\\qquad b^2\\equiv_2 1,\n\\] il che implicherebbe \\[\n  a^2+b^2\\equiv_2 1+1\\equiv_2 2\\equiv_2 0,\n\\] e quindi \\(n\\equiv_2 0\\), impossibile perché \\(n\\) è dispari.\nAllo stesso modo, se \\(a\\) e \\(b\\) fossero entrambi pari, allora \\(a^2+b^2\\equiv_2 0\\), che è ancora impossibile.\nDunque uno è dispari e l’altro è pari. Chiamiamo \\(a\\) quello dispari e \\(b\\) quello pari. Abbiamo \\[\n  a\\equiv_2 1,\\qquad b\\equiv_2 0.\n\\]\nPoiché \\(b\\) è pari, quando dividiamo \\(b\\) per \\(4\\) otteniamo resto \\(0\\) oppure resto \\(2\\) (altrimenti sarebbe dispari). Quindi \\[\n  b\\equiv_4 0 \\quad\\text{oppure}\\quad b\\equiv_4 2.\n\\] In entrambi i casi otteniamo \\[\n  b^2\\equiv_4 0.\n\\]\nAllo stesso modo, poiché \\(a\\) è dispari, abbiamo \\[\n  a\\equiv_4 1 \\quad\\text{oppure}\\quad a\\equiv_4 3.\n\\] In entrambi i casi (controlla!) otteniamo \\[\n  a^2\\equiv_4 1.\n\\]\nQuindi \\[\n  a^2+b^2\\equiv_4 1+0\\equiv_4 1,\n\\] il che significa che \\[\n  n\\equiv_4 1.\n\\]"
  },
  {
    "objectID": "IT/fermat-christmas-theorem/integer-congruences/integer-congruences-IT.html#numeri-invertibili-modulo-q",
    "href": "IT/fermat-christmas-theorem/integer-congruences/integer-congruences-IT.html#numeri-invertibili-modulo-q",
    "title": "Aritmetica modulare di base",
    "section": "Numeri invertibili modulo \\(q\\)",
    "text": "Numeri invertibili modulo \\(q\\)\nRicordiamo che cos’è il massimo comun divisore.\n\nDefinizione: Siano \\(n\\) e \\(m\\) due interi diversi da \\(0\\). Il massimo comun divisore \\(\\mathrm{MCD}(n,m)\\) è il prodotto dei primi comuni che compaiono nelle fattorizzazioni di \\(n\\) e \\(m\\), presi con la potenza più piccola.\n\n\nExample 2 Calcoliamo il massimo comun divisore tra \\(72\\) e \\(540\\). Abbiamo \\[\n  72=2^3\\cdot 3^2,\\qquad 540=2^2\\cdot 3^3\\cdot 5,\n\\] quindi \\[\n  \\mathrm{MCD}(72,540)=2^2\\cdot 3^2.\n\\]\n\nSupponiamo di avere due interi \\(n\\) e \\(q\\) con \\(q&gt;0\\). Ci chiediamo quando esiste un altro intero \\(m\\) tale che \\[\n  n\\cdot m\\equiv_q 1.\n\\] Proviamo qualche esempio:\n\nSe \\(n=4\\) e \\(q=7\\), allora \\[\n  4\\cdot 2\\equiv_7 1.\n\\]\nSe \\(n=4\\) e \\(q=6\\), allora non possiamo trovare un tale \\(m\\).\nSe \\(n=3\\) e \\(q=9\\), non possiamo trovare un tale \\(m\\).\nSe \\(n=3\\) e \\(q=5\\), allora \\[\n  3\\cdot 2\\equiv_5 1.\n\\]\n\nProva qualche esempio anche tu.\n\nDefinizione: Siano \\(n\\) e \\(q\\) interi con \\(q&gt;0\\). Diciamo che \\(n\\) è invertibile modulo \\(q\\) se esiste un intero \\(m\\) tale che \\[\n  n\\cdot m\\equiv_q 1.\n\\]\n\nLa risposta alla domanda è data dalla proposizione seguente.\n\nProposition 4 Siano \\(n\\) e \\(q\\) interi con \\(q&gt;0\\). Allora \\(n\\) è invertibile modulo \\(q\\) se e solo se \\(\\mathrm{MCD}(n,q)=1\\)."
  },
  {
    "objectID": "IT/fermat-christmas-theorem/integer-congruences/integer-congruences-IT.html#teorema-cinese-del-resto",
    "href": "IT/fermat-christmas-theorem/integer-congruences/integer-congruences-IT.html#teorema-cinese-del-resto",
    "title": "Aritmetica modulare di base",
    "section": "Teorema Cinese del Resto",
    "text": "Teorema Cinese del Resto\nOra enunciamo il teorema che ci permetterà di risolvere in modo efficiente il problema degli autobus.\n\nTheorem 1 Siano \\(s,t&gt;1\\) interi con \\(\\mathrm{MCD}(s,t)=1\\). Allora per ogni intero \\(a\\) e ogni intero \\(b\\) esiste un intero \\(x\\) tale che \\[\n  x\\equiv_s a\n  \\qquad\\text{e}\\qquad\n  x\\equiv_t b.\n\\]\n\n\nProof. Vogliamo \\[\n  x\\equiv_s a\n  \\qquad\\text{e}\\qquad\n  x\\equiv_t b.\n\\] La prima congruenza \\(x\\equiv_s a\\) significa che \\(x-a\\) è divisibile per \\(s\\), quindi \\(x\\) è della forma \\[\n  x = a + s\\cdot n\n\\] per qualche intero \\(n\\).\nOra imponiamo la seconda congruenza. Vogliamo \\(x\\equiv_t b\\), cioè \\[\n  a+s\\cdot n \\equiv_t b.\n\\] Sottraiamo \\(a\\) da entrambi i membri: \\[\n  s\\cdot n \\equiv_t b-a.\n\\] Quindi l’intero problema diventa: possiamo risolvere \\[\n  s\\cdot n \\equiv_t (b-a)?\n\\]\nPoiché \\(\\mathrm{MCD}(s,t)=1\\), per Proposition 4 il numero \\(s\\) è invertibile modulo \\(t\\). Questo significa che esiste un intero \\(u\\) tale che \\[\n  s\\cdot u \\equiv_t 1.\n\\] Ora moltiplichiamo la congruenza \\(s\\cdot n \\equiv_t (b-a)\\) per \\(u\\): \\[\n  (s\\cdot u)\\cdot n \\equiv_t u\\cdot (b-a).\n\\] Ma \\(s\\cdot u\\equiv_t 1\\), quindi il lato sinistro diventa \\[\n  1\\cdot n \\equiv_t u(b-a),\n\\] cioè \\[\n  n \\equiv_t u(b-a).\n\\] Quindi, se scegliamo \\(n:=u(b-a)\\), otteniamo una soluzione, che è \\[\n  x=a+s\\cdot u(b-a).\n\\]\n\n\nRemark 3. Osserviamo che Theorem 1 ci dice che una soluzione esiste. Tuttavia, in generale la soluzione non è unica. Infatti, supponiamo di avere una soluzione \\(x\\). Allora anche \\(x+st\\) è una soluzione, perché \\[\n  x+st\\equiv_s x,\\qquad x+st\\equiv_t x.\n\\] In particolare, dopo aver trovato una soluzione \\(x\\), tutte le altre soluzioni sono della forma \\(x+st\\cdot k\\) con \\(k\\) un intero."
  },
  {
    "objectID": "posts/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem.html",
    "href": "posts/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem.html",
    "title": "Proof of Fermat’s Christmas Theorem",
    "section": "",
    "text": "ITA ENG"
  },
  {
    "objectID": "posts/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem.html#if-p-is-not-prime-in-mathbb-zi-then--1-is-a-square-mod-p",
    "href": "posts/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem.html#if-p-is-not-prime-in-mathbb-zi-then--1-is-a-square-mod-p",
    "title": "Fermat’s Christmas Theorem via Gaussian integers",
    "section": "4.1 If \\(p\\) is not prime in \\(\\mathbb Z[i]\\), then \\(-1\\) is a square mod \\(p\\)",
    "text": "4.1 If \\(p\\) is not prime in \\(\\mathbb Z[i]\\), then \\(-1\\) is a square mod \\(p\\)\nAssume \\(p\\) is not prime in \\(\\mathbb Z[i]\\). By the previous section we can write \\[\np=a^2+b^2\n\\] with \\(a,b\\in\\mathbb Z\\), and for an odd prime \\(p\\) we necessarily have \\(ab\\ne 0\\).\nReduce mod \\(p\\): \\[\na^2 \\equiv -b^2 \\pmod p.\n\\] Since \\(b\\not\\equiv 0\\pmod p\\), it has an inverse mod \\(p\\), and we get \\[\n\\left(ab^{-1}\\right)^2 \\equiv -1 \\pmod p.\n\\] So \\(-1\\) is a square modulo \\(p\\)."
  },
  {
    "objectID": "posts/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem.html#if--1-is-a-square-mod-p-then-p-is-not-prime-in-mathbb-zi",
    "href": "posts/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem.html#if--1-is-a-square-mod-p-then-p-is-not-prime-in-mathbb-zi",
    "title": "Fermat’s Christmas Theorem via Gaussian integers",
    "section": "4.2 If \\(-1\\) is a square mod \\(p\\), then \\(p\\) is not prime in \\(\\mathbb Z[i]\\)",
    "text": "4.2 If \\(-1\\) is a square mod \\(p\\), then \\(p\\) is not prime in \\(\\mathbb Z[i]\\)\nAssume \\(p\\) is an odd prime and there exists \\(x\\in\\mathbb Z\\) such that \\[\nx^2 \\equiv -1 \\pmod p.\n\\] Equivalently, \\[\np\\mid (x^2+1)=N(x+i).\n\\] In \\(\\mathbb Z[i]\\) this means \\[\np \\mid (x+i)(x-i).\n\\]\nNow here is the point: in \\(\\mathbb Z[i]\\), irreducible = prime (this uses that \\(\\mathbb Z[i]\\) is Euclidean, hence a UFD). Therefore, if \\(p\\) were prime in \\(\\mathbb Z[i]\\), from \\(p\\mid (x+i)(x-i)\\) we would get \\[\np\\mid (x+i)\\quad\\text{or}\\quad p\\mid (x-i).\n\\] Say \\(p\\mid (x+i)\\). Then \\(x+i=p(a+bi)\\) for some \\(a+bi\\in\\mathbb Z[i]\\). Looking at imaginary parts gives \\[\n1=pb,\n\\] which is impossible since \\(p&gt;1\\). Same contradiction if \\(p\\mid (x-i)\\).\nTherefore \\(p\\) cannot be prime in \\(\\mathbb Z[i]\\).\n\nPutting 4.1 and 4.2 together:\n\nProposition. For an odd prime \\(p\\),\n\\[-1\\text{ is a square mod }p \\quad\\Longleftrightarrow\\quad p\\text{ is not prime in }\\mathbb Z[i].\\]"
  },
  {
    "objectID": "posts/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem.html#exercise-1-infinitely-many-primes-are-sums-of-two-squares",
    "href": "posts/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem.html#exercise-1-infinitely-many-primes-are-sums-of-two-squares",
    "title": "Fermat’s Christmas Theorem via Gaussian integers",
    "section": "Exercise 1: infinitely many primes are sums of two squares",
    "text": "Exercise 1: infinitely many primes are sums of two squares\nProve that there are infinitely many primes that can be written as the sum of two squares.\n\n\nHint 1\n\nA prime \\(p\\) is a sum of two squares if and only if \\(-1\\) is a square mod \\(p\\).\nTry to rephrase “\\(-1\\) is a square mod \\(p\\)” as a divisibility statement in \\(\\mathbb Z\\).\n\n\n\nSolution to Hint 1\n\n\\(-1\\) is a square mod \\(p\\) iff there exists \\(n\\in\\mathbb Z\\) with \\[\nn^2\\equiv -1\\pmod p,\n\\] i.e. \\[\np\\mid (n^2+1).\n\\] So primes with \\(-1\\) a square mod \\(p\\) are exactly the primes that divide some integer of the form \\(n^2+1\\).\n\n\n\nHint 2\n\nAssume there are only finitely many primes \\(p\\) such that \\(-1\\) is a square mod \\(p\\), and let \\(k\\) be their product.\nTry to imitate Euclid’s proof of infinitely many primes.\n\n\n\nHint 3\n\nLook at \\(k^2+1\\). Which primes can divide it?\n\n\n\nSolution to Hint 3\n\nIf \\(p\\) divides \\(k^2+1\\), then \\[\nk^2\\equiv -1\\pmod p,\n\\] so \\(-1\\) is a square mod \\(p\\). By construction \\(p\\) must be among the primes dividing \\(k\\), hence \\(p\\mid k\\).\nBut if \\(p\\mid k\\) and \\(p\\mid(k^2+1)\\), then \\(p\\mid 1\\), impossible.\nContradiction. So there must be infinitely many primes with \\(-1\\) a square mod \\(p\\), hence infinitely many primes that are sums of two squares."
  },
  {
    "objectID": "posts/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem.html#exercise-2-which-integers-are-sums-of-two-squares",
    "href": "posts/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem.html#exercise-2-which-integers-are-sums-of-two-squares",
    "title": "Proof of Fermat’s Christmas Theorem",
    "section": "Exercise 2: which integers are sums of two squares?",
    "text": "Exercise 2: which integers are sums of two squares?\n\n\nExercise 2\nWhich integers \\(n\\ge 1\\) can be written as \\(n=a^2+b^2\\)?\n\n\n\n\nHint 1\n\nWhat happens if \\(n\\) is the product of two primes that can be written as the sum of two squares?\n\n\n\nSolution to Hint 1\n\nIf \\(p=a^2+b^2\\) and \\(q=c^2+d^2\\), then \\(pq\\) is again a sum of two squares. Indeed a sum of two squares can be written as a Gaussian integer times its conjugate: \\[\n    a^2+b^2=(a+bi)(a-bi),\\qquad c^2+d^2=(c+di)(c-di).\n  \\] Therefore \\[\n    (a^2+b^2)(c^2+d^2)=(a+bi)(a-bi)(c+di)(c-di).\n  \\] The factor \\((a+bi)(c+di)\\) is a Gaussian integer, and \\((a-bi)(c-di)\\) is its conjugate. So their product is a sum of two squares.\n\n\n\nHint 2\n\nConsider the number \\(5\\cdot 7^2\\). Can it be written as a sum of two squares?\n\n\n\nSolution to Hint 2\n\nYes: \\[\n  5\\cdot 7^2=245=14^2+7^2.\n  \\] (So the prime \\(7\\equiv_4 3\\) is not “forbidden”, but its exponent seems to matter.)\n\n\n\nHint 3\n\nIn the previous hint, \\(5\\equiv_4 1\\) and \\(7\\equiv_4 3\\). What theorem do you expect?\n\n\n\nSolution to Hint 3 (the statement)\n\nTheorem (sum of two squares). A positive integer \\(n\\) can be written as \\(n=a^2+b^2\\) if and only if, in the prime factorization of \\(n\\), every prime \\(q\\equiv_4 3\\) appears with an even exponent.\n\n\n\nComplete proof (guided by the hints)\n\nStep 1: primes \\(q\\equiv_4 3\\) must appear an even number of times.\nWe first prove the following lemma:\n\nLemma 4 Let \\(q\\) be a prime with \\(q\\equiv_4 3\\). If \\(q\\mid (a^2+b^2)\\), then \\(q\\mid a\\) and \\(q\\mid b\\).\n\n\nProof. Suppose \\(q\\mid (a^2+b^2)\\). If \\(q\\nmid b\\), then \\(b\\) has an inverse \\(u\\) modulo \\(q\\), and \\[\n  \\left(a\\cdot u\\right)^2\\equiv_q -1,\n  \\] so \\(-1\\) is a square mod \\(q\\). But by Fermat’s Christmas theorem, this would force \\(q\\equiv_4 1\\), contradiction. Therefore \\(q\\mid b\\). Then \\(q\\mid a^2\\) and hence \\(q\\mid a\\).\n\nNow assume \\(n=a^2+b^2\\). Take a prime \\(q\\equiv_4 3\\) dividing \\(n\\). By the lemma, \\(q\\) divides both \\(a\\) and \\(b\\), so \\(q^2\\) divides \\(a^2+b^2=n\\). This means that in the prime factorization of \\(n\\), the exponent of \\(q\\) cannot be odd: it must be even.\nStep 2: the converse.\nNow suppose \\(n\\) has the property that every prime \\(q\\equiv_4 3\\) appears with an even exponent. So we can write \\(n\\) as a product of three types of factors:\n\na power of \\(2\\),\nprimes \\(p\\equiv_4 1\\) (possibly repeated),\nand squares of primes \\(q\\equiv_4 3\\) (possibly repeated).\nEach of these factors is a sum of two squares:\n\\(2=1^2+1^2\\),\nif \\(p\\equiv_4 1\\) then \\(p\\) is a sum of two squares by Fermat’s Christmas theorem,\nand if you have a square \\(q^{2m}\\) then \\(q^{2m}=(q^m)^2+0^2\\).\nFinally, by Hint 1, a product of sums of two squares (check that the arguments works not only for primes) is again a sum of two squares. Therefore \\(n\\) is a sum of two squares."
  },
  {
    "objectID": "posts/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem.html#a-small-interactive-counter-runs-in-your-browser",
    "href": "posts/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem.html#a-small-interactive-counter-runs-in-your-browser",
    "title": "Fermat’s Christmas Theorem via Gaussian integers",
    "section": "A small interactive counter (runs in your browser)",
    "text": "A small interactive counter (runs in your browser)\nType a bound \\(N\\) and this will count primes \\(\\le N\\) and how many satisfy \\(p=2\\) or \\(p\\equiv_4 1\\). This is exactly the same as “how many primes \\(\\le N\\) are sums of two squares”.\n\n\n&lt;label for=\"sum2sqN\"&gt;&lt;strong&gt;Bound&lt;/strong&gt; $N$:&lt;/label&gt;\n&lt;input id=\"sum2sqN\" type=\"number\" value=\"100000\" min=\"2\" step=\"1\" style=\"max-width: 12rem; padding: 0.25rem 0.4rem;\"&gt;\n&lt;button id=\"sum2sqRun\" style=\"padding: 0.25rem 0.6rem; cursor:pointer;\"&gt;Compute&lt;/button&gt;\n&lt;span id=\"sum2sqStatus\" style=\"opacity:0.8;\"&gt;&lt;/span&gt;\n\n\n\n\n\nNote: this is a simple sieve in JavaScript, so very large $N$ will be slow in a browser tab."
  },
  {
    "objectID": "posts/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem.html#exercise-1-infinitely-many-primes-that-are-sums-of-two-squares",
    "href": "posts/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem.html#exercise-1-infinitely-many-primes-that-are-sums-of-two-squares",
    "title": "Proof of Fermat’s Christmas Theorem",
    "section": "Exercise 1: infinitely many primes that are sums of two squares",
    "text": "Exercise 1: infinitely many primes that are sums of two squares\n\n\nExercise 1\nProve that there are infinitely many primes that can be written as the sum of two squares.\n\n\n\n\nHint 1\n\nA prime is a sum of two squares if and only if \\(-1\\) is a square mod \\(p\\). Suppose there are only finitely many primes such that \\(-1\\) is a square mod \\(p\\). What can you say?\n\n\n\nSolution to Hint 1\n\nSaying “\\(-1\\) is a square mod \\(p\\)” means: there exists an integer \\(n\\) such that \\[\n  n^2\\equiv_p -1,\n  \\] i.e. \\(p\\mid (n^2+1)\\). So every prime for which \\(-1\\) is a square mod \\(p\\) divides at least one number of the form \\(n^2+1\\).\n\n\n\nHint 2\n\nLet \\(k\\) be the product of all primes \\(p\\) such that \\(-1\\) is a square mod \\(p\\). Try to imitate Euclid’s proof that there are infinitely many primes.\n\n\n\nHint 3\n\nConsider the integer \\(k^2+1\\). Which primes can divide it?\n\n\n\nSolution to Hint 3 (and end of the exercise)\n\nTake a prime \\(q\\) dividing \\(k^2+1\\). Then \\[\n  k^2\\equiv_q -1,\n  \\] so \\(-1\\) is a square mod \\(q\\). By definition of \\(k\\), this forces \\(q\\mid k\\).\nBut then \\(q\\) divides both \\(k\\) and \\(k^2+1\\), hence it divides their difference \\((k^2+1)-k^2=1\\), impossible. Contradiction.\nTherefore the assumption “only finitely many primes with \\(-1\\) a square mod \\(p\\)” was false, and there are infinitely many such primes. By Fermat’s Christmas theorem, these are exactly the primes that are sums of two squares."
  },
  {
    "objectID": "posts/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem.html#gaussian-integers",
    "href": "posts/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem.html#gaussian-integers",
    "title": "Fermat’s Christmas Theorem via Gaussian integers",
    "section": "Gaussian integers",
    "text": "Gaussian integers\nWe all know that the equation \\[\n    x^2+1=0\n\\tag{1}\\] has no solutions, since squares are always positive, and if we add \\(1\\) to a positive number we can’t get zero. Right?\nWell, let’s add the solution of this equation to the integers, we define \\[\ni:=\\sqrt{-1}\n\\] so that we get \\[\n    i^2+1=\\sqrt{-1}^2+1=-1+1=0\n\\]\nWe now have a solution to Equation 1.\nWe define \\(\\mathbb{Z}[i]\\) to be the set of integers at which we add this \\(i\\). The “numbers” in \\(\\mathbb{Z}[i]\\) are of the form \\(a+b\\cdot i\\), where \\(a\\) and \\(b\\) are usual integers. For example, \\(1+2i\\), \\(5+7i\\), and \\(0+i\\) are all gaussian integers. The special cases of numbers of the form \\(a+0\\cdot i\\) will be just denoted by \\(a\\), while the numbers \\(0+b\\cdot i\\) will be denoted just by \\(bi\\). In particular observe that we have all the integers inside \\(\\mathbb{Z}[i]\\), indeed we can recover them by the numbers of the form \\(a+0\\cdot i=a\\).\nBut why should we work in gaussian integers instead of classical integers? We will understand why later, since the existence of a solution for the congruence \\[\nx^2+1\\equiv_p 0\n\\] is closely related to \\(p\\) being a sum of two squares.\nFirst of all, how do products and sum work in the Gaussian integers?\nIt is easy, you just have to treat \\(i\\) as a formal variable, and remember that \\(i^2=1\\). I will explain it better:\nSuppose we want to sum \\(3+2i\\) with \\(5+i\\). Then we do like this: \\[\n    (3+2i)+(5+i)=(3+5)+(2+1)i=8+3i\n\\] so we add the numbers that havent the \\(i\\) with them and the numbers that have the \\(i\\) with them separately. Other examples: \\[\n    (-2+4i)+(7-3i)=5+i,\\qquad (3+6i)-i=3+7i,\\qquad 3+(-1+i)=2+i.\n\\]\nSimilarly we do for the products, we just treat \\(i\\) as a formal variable: \\[\n    (3+2i)\\cdot(5+i)=3\\cdot 5+ 3\\cdot i+2i\\cdot 5+2i\\cdot i=15+3i+10i+2i^2=15+2i^2+13i\n\\] Now remember that \\(i^2=-1\\) so \\(2i^2=-2\\), thus \\[\n    15+2i^2+13i=15-2+13i=13+13i\n\\]\nOther examples: \\[\n    (-2+4i)(7-3i)=-2+34i,\\qquad, (3+6i)\\cdot (-i)=6-3i,\\qquad 3\\cdot (-1+i)=-3+3i\n\\]\nNow, define the following:\n\nDefinition: Let \\(a+bi\\) be a Gaussian integer. We define its conjugate as \\(a-bi\\).\n\n\nExample 1  \n\nThe conjugate of \\(3+4i\\) is \\(3-4i\\).\nThe conjugate of \\(1-i\\) is \\(1+i\\).\nThe conjugate of \\(4\\) is \\(4\\).\nThe conjugate of \\(-6i\\) is \\(6i\\).\n\n\nNow observe this userful thing. If you multiply a Gaussian integer \\(a+bi\\) by its conjugate \\(a-bi\\) you get \\[\n    (a+bi)(a-bi)=a^2-abi+abi-b^2i^2=a^2-b^2i^2\n\\] and since \\(i^2=-1\\) we get \\[\n    (a+bi)(a-bi)=a^2+b^2\n\\]\nThis is nice, isn’t it? Our goal is to understand when an prime is sum of two squares and now we have an easy way to write a sum of two squares."
  },
  {
    "objectID": "posts/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem.html#what-we-proved-so-far",
    "href": "posts/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem.html#what-we-proved-so-far",
    "title": "Fermat’s Christmas Theorem via Gaussian integers",
    "section": "What we proved so far?",
    "text": "What we proved so far?\nLet \\(p\\) be a prime in the integers. We proved that\n\nif \\(p\\) is the sum of two squares then \\(p\\equiv_4 1\\);\nif $$"
  },
  {
    "objectID": "posts/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem.html#what-is-a-prime-in-the-gaussian-integers",
    "href": "posts/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem.html#what-is-a-prime-in-the-gaussian-integers",
    "title": "Proof of Fermat’s Christmas Theorem",
    "section": "What is a prime in the Gaussian integers?",
    "text": "What is a prime in the Gaussian integers?\nIf you remember, in the second post we defined a prime \\(p\\) as a number such that whenever \\(p\\) divides a product \\(a\\cdot b\\), then either \\(p\\) divides \\(a\\) or \\(p\\) divides \\(b\\). We now do the same in the Gaussian integers. First we define what it means to divide something in the Gaussian integers.\n\nDefinition: Let \\(a+bi\\) be a Gaussian integer. We say that \\(a+bi\\) divides \\(c+di\\) if we can write \\[\n    c+di=(a+bi)\\cdot (e+fi)\n\\] for some Gaussian integer \\(e+fi\\).\n\n\nDefinition: Let \\(a+bi\\) be a Gaussian integer. We say that \\(a+bi\\) is prime if whenever \\(a+bi\\) divides a product \\((c+di)(e+fi)\\) then either \\(a+bi\\) divides \\(c+di\\) or \\(a+bi\\) divides \\(e+fi\\).\n\nWe will not prove the following theorem, whose proof is in some way similar to the one made for the integers.\n\nTheorem 2 (Unique factorization) Every Gaussian integer \\(a+bi\\) can be written as the product of Gaussian integer primes, i.e. \\[\n    a+bi=(c_1+d_1i)\\cdots(c_k+d_ki)\n\\] for some positive integer \\(k\\). This writing is unique up to multiplying by \\(-1, i,\\) and \\(-i\\).\n\nLet’s clarify this uniqueness, which is a little bit strange. What we are saying is that if you consider a Gaussian integer like \\(1+3i\\), you can factorize it as \\[\n    1+3i=(1+i)(2+i)\n\\] (you can check that \\(1+i\\) and \\(2+i\\) are primes by using the definition, but it is maybe a little tedious). Observe now that \\(i\\cdot (-i)=-i^2=1\\). Therefore we can write \\[\n    1+3i=1\\cdot (1+i)(2+i)=(i\\cdot (-i))(1+i)(2+i)=i\\cdot ((-i)\\cdot (1+i))(2+i)=i\\cdot (1-i)(2+i)\n\\] this seems to be another factorization of \\(1+3i\\). However, it differs from the other one only because we multiplied by \\(1=i\\cdot (-i)\\). Therefore, we say that up to multiplying by these special numbers (if you think about it you can also do the same by writing \\(1=(-1)\\cdot (-1)\\) and \\(1=(-i)\\cdot i\\)) the factorization is unique."
  },
  {
    "objectID": "posts/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem.html#primes-in-the-integers-which-are-not-primes-in-the-gaussian-integers",
    "href": "posts/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem.html#primes-in-the-integers-which-are-not-primes-in-the-gaussian-integers",
    "title": "Proof of Fermat’s Christmas Theorem",
    "section": "Primes in the integers which are not primes in the Gaussian integers",
    "text": "Primes in the integers which are not primes in the Gaussian integers\n\nLemma 2 Let \\(p\\) be a prime number. If \\(p+0i\\) is not prime in \\(\\mathbb{Z}[i]\\), then we can write \\(p\\) as a sum of two squares.\n\n\nProof. If \\(p+0i\\) is not prime, then it can be written as a product of two factors: \\[\n    p+0i=(a+bi)(c+di)\n\\] where neither \\(a+bi\\) nor \\(c+di\\) are equal to \\(1,-1,i,-i\\).\nNow multiply both sides by their conjugates. On the left we get \\[\n    (p+0i)(p-0i)=p^2.\n\\] On the right we get \\[\n    (a+bi)(a-bi)(c+di)(c-di)=(a^2+b^2)(c^2+d^2).\n\\] Therefore \\[\n    p^2=(a^2+b^2)(c^2+d^2).\n\\]\nWe have \\(a^2+b^2&gt;1\\) and \\(c^2+d^2&gt;1\\). But \\(p\\) is prime in \\(\\mathbb{Z}\\), so the only way two integers bigger than \\(1\\) can multiply to \\(p^2\\) is that \\[\n    a^2+b^2=p,\\qquad c^2+d^2=p.\n\\] In particular, \\[\n    p=a^2+b^2,\n\\] which means that \\(p\\) is a sum of two squares."
  },
  {
    "objectID": "posts/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem.html#wilson-theorem-and-solution-to-x21equiv_p-0",
    "href": "posts/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem.html#wilson-theorem-and-solution-to-x21equiv_p-0",
    "title": "Proof of Fermat’s Christmas Theorem",
    "section": "Wilson theorem and solution to \\(x^2+1\\equiv_p 0\\)",
    "text": "Wilson theorem and solution to \\(x^2+1\\equiv_p 0\\)\nWe will use the following theorem to prove what we need.\n\nTheorem 3 (Wilson’s Theorem) If \\(p\\) is a prime number, then \\[\n(p-1)\\cdot (p-2)\\cdot (p-3)\\cdots 2\\cdot 1 \\equiv_p p-1.\n\\] i.e. multiplying all numbers from \\(p-1\\) to \\(1\\) we get \\(p-1\\) modulo \\(p\\).\n\nWe give an idea of how to prove this theorem.\n\nProof (Idea). Recall that an integer \\(x\\) is invertible modulo \\(p\\) if and only if \\(\\gcd(x,p)=1\\). Since \\(p\\) is prime, it has no common factors with any of the numbers \\((p-1),(p-2),\\dots,2,1\\). This means that every factor on the left hand side is invertible modulo \\(p\\).\nNow, when you list all the invertible residues modulo \\(p\\), you get exactly \\(1,2,\\dots,p-1\\). So on the left hand side, every term appears together with its inverse, except for the terms that are their own inverse.\nAn element \\(a\\) is its own inverse if and only if \\(a^2\\equiv_p 1\\). Modulo a prime, this means \\(a\\equiv_p 1\\) or \\(a\\equiv_p -1\\). Therefore, everything cancels out in pairs, and only \\(-1\\equiv_p p-1\\) remains.\n\n\nLemma 3 If \\(p\\) is a prime such that \\(p\\equiv_4 1\\) then \\(x^2+1\\equiv_p 0\\) has a solution.\n\n\nProof. Since \\(p\\equiv_4 1\\), it means that \\(p-1\\) is divisible by \\(4\\), which means that \\(p-1=4k\\) for some integer \\(k\\). We have then \\[\n    (p-1)\\cdot (p-2)\\cdot (p-3)\\cdots 3\\cdot 2\\cdot 1.\n\\]\nNow group the factors in pairs as follows: \\[\n    (p-1)\\cdot 1\\cdot (p-2)\\cdot 2\\cdots (p-2k)\\cdot (2k).\n\\]\nSince \\(p-j\\equiv_p -j\\), each pair gives \\[\n    (p-j)\\cdot j\\equiv_p (-j)\\cdot j=-j^2.\n\\] Therefore \\[\n    (p-1)\\cdot (p-2)\\cdots 2\\cdot 1\\equiv_p (-1)^2\\cdot (-2)^2\\cdots (-(2k))^2=(1\\cdot 2\\cdot 3\\cdots \\cdot (2k-1)\\cdot 2k)^2.\n\\] (Here the minus signs disappear because we are squaring.)\nBut, by Theorem 3 we also know that the left hand side is congruent to \\(p-1\\) modulo \\(p\\). And since \\(p-1\\equiv_p -1\\) we get that \\[\n    -1\\equiv_p (1\\cdot 2\\cdots (2k-1)\\cdot 2k)^2\n\\] Define \\[\nx:= 1\\cdot 2\\cdots (2k-1)\\cdot 2k\n\\]\nThen we get \\[\n    x^2+1\\equiv_p 0.\n\\] Therefore, we found a solution."
  },
  {
    "objectID": "posts/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem.html#the-theorem-is-proven-what-else-can-we-say",
    "href": "posts/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem.html#the-theorem-is-proven-what-else-can-we-say",
    "title": "Proof of Fermat’s Christmas Theorem",
    "section": "The theorem is proven, what else can we say?",
    "text": "The theorem is proven, what else can we say?\nThe theorem is finally proven, but we don’t stop asking questions. We come up with two questions.\n\nHow many primes can be written as the sum of two squares? Equivalently, how many primes have remainder \\(1\\) when divided by \\(4\\)?\n\nProbably not surprisingly we already expect that there are infinitely many primes that can be written as the sum of two squares. This statement is left as a guided exercise at the end of the post.\nAn interesting, but non trivial fact is to know also the density of these kinds of primes. Namely, if we consider all the primes up to some integer \\(N\\), how many of these do we expect to be written as the sum of two squares? The answer is that we expect about half of them to be of this kind. Indeed here you can see a table which could convince you:\n\n\n\n\\(N\\)\nprimes \\(\\le N\\)\nprimes that are \\(a^2+b^2\\)\nproportion\n\n\n\n\n\\(10^2\\)\n\\(25\\)\n\\(12\\)\n\\(0.48\\)\n\n\n\\(10^3\\)\n\\(168\\)\n\\(81\\)\n\\(0.4821\\ldots\\)\n\n\n\\(10^6\\)\n\\(78498\\)\n\\(39176\\)\n\\(0.49907\\ldots\\)\n\n\n\\(10^9\\)\n\\(50847534\\)\n\\(25423492\\)\n\\(0.499994\\ldots\\)\n\n\n\nThis can be proven, however this is far beyond our interests here.\nAnother natural question now could be\n\nConsider an integer \\(n\\). When can we write it as the sum of two squares?\n\nSo we are trying to generalize from the case of primes to the case of a general integer. This is not difficult to prove knowing Fermat’s Christmas Theorem, therefore it is also left as a guided exercise at the end."
  },
  {
    "objectID": "IT/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem-IT.html",
    "href": "IT/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem-IT.html",
    "title": "Dimostrazione del Teorema di Natale",
    "section": "",
    "text": "ENG ITA"
  },
  {
    "objectID": "IT/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem-IT.html#cosè-un-primo-negli-interi-di-gauss",
    "href": "IT/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem-IT.html#cosè-un-primo-negli-interi-di-gauss",
    "title": "Dimostrazione del Teorema di Natale",
    "section": "Cos’è un primo negli interi di Gauss?",
    "text": "Cos’è un primo negli interi di Gauss?\nSe ti ricordi, nel secondo post abbiamo definito un primo \\(p\\) come un numero tale che, ogni volta che \\(p\\) divide un prodotto \\(a\\cdot b\\), allora \\(p\\) divide \\(a\\) oppure \\(p\\) divide \\(b\\). Ora facciamo lo stesso negli interi di Gauss. Prima definiamo cosa significa dividere qualcosa negli interi di Gauss.\n\nDefinizione: Sia \\(a+bi\\) un intero di Gauss. Diciamo che \\(a+bi\\) divide \\(c+di\\) se possiamo scrivere \\[\n    c+di=(a+bi)\\cdot (e+fi)\n\\] per qualche intero di Gauss \\(e+fi\\).\n\n\nDefinizione: Sia \\(a+bi\\) un intero di Gauss. Diciamo che \\(a+bi\\) è primo se ogni volta che \\(a+bi\\) divide un prodotto \\((c+di)(e+fi)\\), allora \\(a+bi\\) divide \\(c+di\\) oppure \\(a+bi\\) divide \\(e+fi\\).\n\nNon dimostreremo il seguente teorema, la cui dimostrazione è in un certo senso simile a quella fatta per gli interi.\n\nTheorem 2 (Fattorizzazione unica) Ogni intero di Gauss \\(a+bi\\) si può scrivere come prodotto di primi di Gauss, cioè \\[\n    a+bi=(c_1+d_1i)\\cdots(c_k+d_ki)\n\\] per qualche intero positivo \\(k\\). Questa scrittura è unica a meno di moltiplicare per \\(-1, i,\\) e \\(-i\\).\n\nChiariamo questa unicità, che è un po’ strana. Quello che stiamo dicendo è che se consideri un intero di Gauss come \\(1+3i\\), lo puoi fattorizzare come \\[\n    1+3i=(1+i)(2+i)\n\\] (puoi verificare che \\(1+i\\) e \\(2+i\\) sono primi usando la definizione, ma può essere un po’ noioso). Ora osserva che \\(i\\cdot (-i)=-i^2=1\\). Quindi possiamo scrivere \\[\n    1+3i=1\\cdot (1+i)(2+i)=(i\\cdot (-i))(1+i)(2+i)=i\\cdot ((-i)\\cdot (1+i))(2+i)=i\\cdot (1-i)(2+i)\n\\] questa sembra un’altra fattorizzazione di \\(1+3i\\). Tuttavia differisce dalla precedente solo perché abbiamo moltiplicato per \\(1=i\\cdot (-i)\\). Quindi diciamo che, a meno di moltiplicare per questi numeri speciali (se ci pensi puoi fare lo stesso anche con \\(1=(-1)\\cdot(-1)\\) e \\(1=(-i)\\cdot i\\)), la fattorizzazione è unica."
  },
  {
    "objectID": "IT/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem-IT.html#primi-negli-interi-che-non-sono-primi-negli-interi-di-gauss",
    "href": "IT/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem-IT.html#primi-negli-interi-che-non-sono-primi-negli-interi-di-gauss",
    "title": "Dimostrazione del Teorema di Natale",
    "section": "Primi negli interi che non sono primi negli interi di Gauss",
    "text": "Primi negli interi che non sono primi negli interi di Gauss\n\nLemma 2 Sia \\(p\\) un numero primo. Se \\(p+0i\\) non è primo in \\(\\mathbb{Z}[i]\\), allora possiamo scrivere \\(p\\) come somma di due quadrati.\n\n\nProof. Se \\(p+0i\\) non è primo, allora si può scrivere come prodotto di due fattori: \\[\n    p+0i=(a+bi)(c+di)\n\\] dove né \\(a+bi\\) né \\(c+di\\) sono uguali a \\(1,-1,i,-i\\).\nOra moltiplichiamo entrambi i lati per i loro coniugati. A sinistra otteniamo \\[\n    (p+0i)(p-0i)=p^2.\n\\] A destra otteniamo \\[\n    (a+bi)(a-bi)(c+di)(c-di)=(a^2+b^2)(c^2+d^2).\n\\] Quindi \\[\n    p^2=(a^2+b^2)(c^2+d^2).\n\\]\nAbbiamo \\(a^2+b^2&gt;1\\) e \\(c^2+d^2&gt;1\\). Ma \\(p\\) è primo in \\(\\mathbb Z\\), quindi l’unico modo in cui due interi maggiori di \\(1\\) possono moltiplicarsi per dare \\(p^2\\) è che \\[\n    a^2+b^2=p,\\qquad c^2+d^2=p.\n\\] In particolare, \\[\n    p=a^2+b^2,\n\\] cioè \\(p\\) è una somma di due quadrati."
  },
  {
    "objectID": "IT/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem-IT.html#teorema-di-wilson-e-soluzione-di-x21equiv_p-0",
    "href": "IT/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem-IT.html#teorema-di-wilson-e-soluzione-di-x21equiv_p-0",
    "title": "Dimostrazione del Teorema di Natale",
    "section": "Teorema di Wilson e soluzione di \\(x^2+1\\equiv_p 0\\)",
    "text": "Teorema di Wilson e soluzione di \\(x^2+1\\equiv_p 0\\)\nUseremo il seguente teorema per dimostrare ciò che ci serve.\n\nTheorem 3 (Teorema di Wilson) Se \\(p\\) è un numero primo, allora \\[\n(p-1)\\cdot (p-2)\\cdot (p-3)\\cdots 2\\cdot 1 \\equiv_p p-1.\n\\] cioè moltiplicando tutti i numeri da \\(p-1\\) fino a \\(1\\) otteniamo \\(p-1\\) modulo \\(p\\).\n\nDiamo un’idea di come dimostrare questo teorema.\n\nProof (Idea). Ricorda che un intero \\(x\\) è invertibile modulo \\(p\\) se e solo se \\(\\mathrm{MCD}(x,p)=1\\). Siccome \\(p\\) è primo, non ha fattori in comune con nessuno dei numeri \\((p-1),(p-2),\\dots,2,1\\). Questo significa che ogni fattore a sinistra è invertibile modulo \\(p\\).\nOra, se elenchi tutti i residui invertibili modulo \\(p\\), ottieni esattamente \\(1,2,\\dots,p-1\\). Quindi, a sinistra, ogni termine compare insieme al suo inverso, tranne i termini che sono il proprio inverso.\nUn elemento \\(a\\) è il proprio inverso se e solo se \\(a^2\\equiv_p 1\\). Modulo un primo, questo significa \\(a\\equiv_p 1\\) oppure \\(a\\equiv_p -1\\). Quindi tutto si cancella a coppie, e rimane solo \\(-1\\equiv_p p-1\\).\n\n\nLemma 3 Se \\(p\\) è un primo tale che \\(p\\equiv_4 1\\) allora \\(x^2+1\\equiv_p 0\\) ha una soluzione.\n\n\nProof. Dato che \\(p\\equiv_4 1\\), significa che \\(p-1\\) è divisibile per \\(4\\), cioè \\(p-1=4k\\) per qualche intero \\(k\\). Consideriamo \\[\n    (p-1)\\cdot (p-2)\\cdot (p-3)\\cdots 3\\cdot 2\\cdot 1.\n\\]\nOra raggruppiamo i fattori a coppie così: \\[\n    (p-1)\\cdot 1\\cdot (p-2)\\cdot 2\\cdots (p-2k)\\cdot (2k).\n\\]\nSiccome \\(p-j\\equiv_p -j\\), ogni coppia dà \\[\n    (p-j)\\cdot j\\equiv_p (-j)\\cdot j=-j^2.\n\\] Quindi \\[\n    (p-1)\\cdot (p-2)\\cdots 2\\cdot 1\\equiv_p (-1)^2\\cdot (-2)^2\\cdots (-(2k))^2=(1\\cdot 2\\cdot 3\\cdots \\cdot (2k-1)\\cdot 2k)^2.\n\\] (Qui i segni meno spariscono perché stiamo elevando al quadrato.)\nMa per il teorema di Wilson Theorem 3 sappiamo anche che il lato sinistro è congruo a \\(p-1\\) modulo \\(p\\). E siccome \\(p-1\\equiv_p -1\\), otteniamo \\[\n    -1\\equiv_p (1\\cdot 2\\cdots (2k-1)\\cdot 2k)^2\n\\] Definiamo \\[\nx:= 1\\cdot 2\\cdots (2k-1)\\cdot 2k\n\\]\nAllora otteniamo \\[\n    x^2+1\\equiv_p 0.\n\\] Quindi abbiamo trovato una soluzione."
  },
  {
    "objectID": "IT/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem-IT.html#il-teorema-è-dimostrato-cosaltro-possiamo-dire",
    "href": "IT/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem-IT.html#il-teorema-è-dimostrato-cosaltro-possiamo-dire",
    "title": "Dimostrazione del Teorema di Natale",
    "section": "Il teorema è dimostrato, cos’altro possiamo dire?",
    "text": "Il teorema è dimostrato, cos’altro possiamo dire?\nIl teorema è finalmente dimostrato, ma non smettiamo di fare domande. Ne vengono fuori due.\n\nQuanti primi si possono scrivere come somma di due quadrati? Equivalentemente, quanti primi hanno resto \\(1\\) quando li dividiamo per \\(4\\)?\n\nProbabilmente non sorprende che ci aspettiamo che ci siano infiniti primi scrivibili come somma di due quadrati. Questa affermazione è lasciata come esercizio guidato alla fine del post.\nUn fatto interessante, ma non banale, è capire anche la densità di questi primi. Cioè: se consideriamo tutti i primi fino a un intero \\(N\\), quanti di questi ci aspettiamo che siano somme di due quadrati? La risposta è che ci aspettiamo circa la metà. Ecco una tabella che può convincerti:\n\n\n\n\\(N\\)\nprimi \\(\\le N\\)\nprimi che sono \\(a^2+b^2\\)\nproporzione\n\n\n\n\n\\(10^2\\)\n\\(25\\)\n\\(12\\)\n\\(0.48\\)\n\n\n\\(10^3\\)\n\\(168\\)\n\\(81\\)\n\\(0.4821\\ldots\\)\n\n\n\\(10^6\\)\n\\(78498\\)\n\\(39176\\)\n\\(0.49907\\ldots\\)\n\n\n\\(10^9\\)\n\\(50847534\\)\n\\(25423492\\)\n\\(0.499994\\ldots\\)\n\n\n\nQuesto si può dimostrare, ma è ben oltre i nostri interessi qui.\nUn’altra domanda naturale è\n\nDato un intero \\(n\\), quando si può scrivere come somma di due quadrati?\n\nQuindi stiamo generalizzando dal caso dei primi al caso di un intero qualunque. Questo non è difficile da dimostrare conoscendo il teorema di Natale, quindi lo lasciamo come esercizio guidato alla fine."
  },
  {
    "objectID": "IT/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem-IT.html#esercizio-1-infiniti-primi-che-sono-somme-di-due-quadrati",
    "href": "IT/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem-IT.html#esercizio-1-infiniti-primi-che-sono-somme-di-due-quadrati",
    "title": "Dimostrazione del Teorema di Natale",
    "section": "Esercizio 1: infiniti primi che sono somme di due quadrati",
    "text": "Esercizio 1: infiniti primi che sono somme di due quadrati\n\n\nEsercizio 1\nDimostra che esistono infiniti primi che si possono scrivere come somma di due quadrati.\n\n\n\n\nSuggerimento 1\n\nUn primo è una somma di due quadrati se e solo se \\(-1\\) è un quadrato mod \\(p\\). Supponi che ci siano solo finitamenti molti primi tali che \\(-1\\) sia un quadrato mod \\(p\\). Cosa puoi dire?\n\n\n\nSoluzione al Suggerimento 1\n\nDire “\\(-1\\) è un quadrato mod \\(p\\)” significa: esiste un intero \\(n\\) tale che \\[\n  n^2\\equiv_p -1,\n  \\] cioè \\(p\\mid (n^2+1)\\). Quindi ogni primo per cui \\(-1\\) è un quadrato mod \\(p\\) divide almeno un numero della forma \\(n^2+1\\).\n\n\n\nSuggerimento 2\n\nSia \\(k\\) il prodotto di tutti i primi \\(p\\) tali che \\(-1\\) sia un quadrato mod \\(p\\). Prova a imitare la dimostrazione di Euclide che esistono infiniti primi.\n\n\n\nSuggerimento 3\n\nConsidera l’intero \\(k^2+1\\). Quali primi lo possono dividere?\n\n\n\nSoluzione al Suggerimento 3 (e fine dell’esercizio)\n\nSia \\(q\\) un primo che divide \\(k^2+1\\). Allora \\[\n  k^2\\equiv_q -1,\n  \\] quindi \\(-1\\) è un quadrato mod \\(q\\). Per definizione di \\(k\\), questo forza \\(q\\mid k\\).\nMa allora \\(q\\) divide sia \\(k\\) sia \\(k^2+1\\), quindi divide anche la loro differenza \\((k^2+1)-k^2=1\\), impossibile. Contraddizione.\nQuindi l’ipotesi “solo finitamenti molti primi con \\(-1\\) quadrato mod \\(p\\)” è falsa, ed esistono infiniti primi di questo tipo. Per il teorema di Natale, questi sono esattamente i primi che sono somme di due quadrati."
  },
  {
    "objectID": "IT/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem-IT.html#esercizio-2-quali-interi-sono-somme-di-due-quadrati",
    "href": "IT/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem-IT.html#esercizio-2-quali-interi-sono-somme-di-due-quadrati",
    "title": "Dimostrazione del Teorema di Natale",
    "section": "Esercizio 2: quali interi sono somme di due quadrati?",
    "text": "Esercizio 2: quali interi sono somme di due quadrati?\n\n\nEsercizio 2\nQuali interi \\(n\\ge 1\\) si possono scrivere come \\(n=a^2+b^2\\)?\n\n\n\n\nSuggerimento 1\n\nCosa succede se \\(n\\) è il prodotto di due primi che si possono scrivere come somma di due quadrati?\n\n\n\nSoluzione al Suggerimento 1\n\nSe \\(p=a^2+b^2\\) e \\(q=c^2+d^2\\), allora anche \\(pq\\) è una somma di due quadrati. Infatti una somma di due quadrati si può scrivere come un intero di Gauss per il suo coniugato: \\[\n    a^2+b^2=(a+bi)(a-bi),\\qquad c^2+d^2=(c+di)(c-di).\n  \\] Quindi \\[\n    (a^2+b^2)(c^2+d^2)=(a+bi)(a-bi)(c+di)(c-di).\n  \\] Il fattore \\((a+bi)(c+di)\\) è un intero di Gauss, e \\((a-bi)(c-di)\\) è il suo coniugato. Quindi il loro prodotto è una somma di due quadrati.\n\n\n\nSuggerimento 2\n\nConsidera il numero \\(5\\cdot 7^2\\). Si può scrivere come somma di due quadrati?\n\n\n\nSoluzione al Suggerimento 2\n\nSì: \\[\n  5\\cdot 7^2=245=14^2+7^2.\n  \\] (Quindi il primo \\(7\\equiv_4 3\\) non è “vietato”, ma sembra contare l’esponente.)\n\n\n\nSuggerimento 3\n\nNel suggerimento precedente, \\(5\\equiv_4 1\\) e \\(7\\equiv_4 3\\). Che teorema ti aspetti?\n\n\n\nSoluzione al Suggerimento 3 (enunciato)\n\nTeorema (somma di due quadrati). Un intero positivo \\(n\\) si può scrivere come \\(n=a^2+b^2\\) se e solo se, nella fattorizzazione prima di \\(n\\), ogni primo \\(q\\equiv_4 3\\) compare con esponente pari.\n\n\n\nDimostrazione completa (guidata dai suggerimenti)\n\nPasso 1: i primi \\(q\\equiv_4 3\\) devono comparire un numero pari di volte.\nDimostriamo prima il seguente lemma:\n\nLemma 4 Sia \\(q\\) un primo con \\(q\\equiv_4 3\\). Se \\(q\\mid (a^2+b^2)\\), allora \\(q\\mid a\\) e \\(q\\mid b\\).\n\n\nProof. Supponiamo \\(q\\mid (a^2+b^2)\\). Se \\(q\\nmid b\\), allora \\(b\\) ha un inverso \\(u\\) modulo \\(q\\), e \\[\n  \\left(a\\cdot u\\right)^2\\equiv_q -1,\n  \\] quindi \\(-1\\) è un quadrato mod \\(q\\). Ma per il teorema di Natale, questo forzerebbe \\(q\\equiv_4 1\\), contraddizione. Quindi \\(q\\mid b\\). Allora \\(q\\mid a^2\\) e quindi \\(q\\mid a\\).\n\nOra supponi \\(n=a^2+b^2\\). Prendi un primo \\(q\\equiv_4 3\\) che divide \\(n\\). Per il lemma, \\(q\\) divide sia \\(a\\) sia \\(b\\), quindi \\(q^2\\) divide \\(a^2+b^2=n\\). Questo significa che nella fattorizzazione prima di \\(n\\) l’esponente di \\(q\\) non può essere dispari: deve essere pari.\nPasso 2: il converso.\nOra supponi che \\(n\\) abbia la proprietà che ogni primo \\(q\\equiv_4 3\\) compaia con esponente pari. Allora possiamo pensare \\(n\\) come prodotto di tre tipi di fattori:\n\nuna potenza di \\(2\\),\nprimi \\(p\\equiv_4 1\\) (anche ripetuti),\ne quadrati di primi \\(q\\equiv_4 3\\) (anche ripetuti).\nOgnuno di questi fattori è una somma di due quadrati:\n\\(2=1^2+1^2\\),\nse \\(p\\equiv_4 1\\) allora \\(p\\) è una somma di due quadrati per il teorema di Natale,\ne se hai un quadrato \\(q^{2m}\\) allora \\(q^{2m}=(q^m)^2+0^2\\).\nInfine, per il Suggerimento 1, un prodotto di somme di due quadrati è ancora una somma di due quadrati. Quindi \\(n\\) è una somma di due quadrati."
  },
  {
    "objectID": "posts/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem.html#fermats-christmas-theorem-1",
    "href": "posts/fermat-christmas-theorem/proof-of-the-theorem/proof-of-the-theorem.html#fermats-christmas-theorem-1",
    "title": "Proof of Fermat’s Christmas Theorem",
    "section": "Fermat’s Christmas Theorem",
    "text": "Fermat’s Christmas Theorem\nAn odd prime number \\(p\\) can be written as \\(p=a^2+b^2\\) with \\(a,b\\in\\mathbb Z\\) if and only if \\(p\\equiv_4 1\\).\n:::\nIn the previous post we proved that if \\(p\\) can be written as the sum of two squares, then it has remainder \\(1\\) when divided by \\(4\\), i.e. \\(p\\equiv_4 1\\). Now we want to prove the converse: if \\(p\\equiv_4 1\\), then \\(p\\) can be written as the sum of two squares (this is the hard part).\nIn this post we develop everything we need in order to give a complete proof of the theorem. First, we shift the problem to the context of Gaussian integers, which are an extension of the integers we know. Then we will see how sums of two squares appear naturally there, and how to recognize the primes that can be written as the sum of two squares."
  }
]